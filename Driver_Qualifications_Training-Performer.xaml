<Activity mc:Ignorable="sap sap2010" x:Class="Main" VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="1110,1267" sap2010:WorkflowViewState.IdRef="Main2_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:s="clr-namespace:System;assembly=System.Private.CoreLib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:sc="clr-namespace:System.ComponentModel;assembly=System.ComponentModel.TypeConverter" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data.Common" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:uix="http://schemas.uipath.com/workflow/activities/uix" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="102">
      <x:String>GlobalConstantsNamespace</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>System</x:String>
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Runtime.Collections</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Security</x:String>
      <x:String>System.Threading.Tasks</x:String>
      <x:String>System.Windows.Forms</x:String>
      <x:String>System.Windows.Forms.Integration</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>UiPath.Core.Activities.Orchestrator</x:String>
      <x:String>UiPath.Core.Activities.Storage</x:String>
      <x:String>UiPath.CSV</x:String>
      <x:String>UiPath.CSV.Activities</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>UiPath.Database.Activities</x:String>
      <x:String>UiPath.DataTableUtilities</x:String>
      <x:String>UiPath.DocumentProcessing.Contracts.Taxonomy</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>UiPath.Excel.Activities.Business</x:String>
      <x:String>UiPath.Orchestrator.Client.Models</x:String>
      <x:String>UiPath.Platform.ObjectLibrary</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>UiPath.Platform.Triggers</x:String>
      <x:String>UiPath.Platform.Triggers.Scope</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>UiPath.Shared.Activities.Business</x:String>
      <x:String>UiPath.UIAutomationCore.Contracts</x:String>
      <x:String>UiPath.UIAutomationNext.Activities</x:String>
      <x:String>UiPath.UIAutomationNext.Activities.Triggers</x:String>
      <x:String>UiPath.UIAutomationNext.Enums</x:String>
      <x:String>UiPath.UIAutomationNext.Triggers</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.SMTP.Activities</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>System.Linq.Expressions</x:String>
      <x:String>System.Numerics</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="152">
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic.Core</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic.Forms</AssemblyReference>
      <AssemblyReference>Microsoft.Win32.Primitives</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.CodeDom</AssemblyReference>
      <AssemblyReference>System.Collections</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.Collections.NonGeneric</AssemblyReference>
      <AssemblyReference>System.ComponentModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ComponentModel.EventBasedAsync</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Primitives</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Configuration.ConfigurationManager</AssemblyReference>
      <AssemblyReference>System.Console</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Data.SqlClient</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.AccessControl</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.DriveInfo</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.Watcher</AssemblyReference>
      <AssemblyReference>System.IO.Packaging</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Linq.Async</AssemblyReference>
      <AssemblyReference>System.Linq.Async.Queryable</AssemblyReference>
      <AssemblyReference>System.Linq.Expressions</AssemblyReference>
      <AssemblyReference>System.Linq.Parallel</AssemblyReference>
      <AssemblyReference>System.Linq.Queryable</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Memory.Data</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Private.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Private.Uri</AssemblyReference>
      <AssemblyReference>System.Private.Xml</AssemblyReference>
      <AssemblyReference>System.Runtime.InteropServices</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>System.Security.Permissions</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Threading.Tasks.Parallel</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.Windows.Forms</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>System.Xml.ReaderWriter</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>UiPath.Database.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Core</AssemblyReference>
      <AssemblyReference>UiPath.OrchestratorClient</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>UiPath.Semantic.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.ViewModels</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Vision.Core</AssemblyReference>
      <AssemblyReference>UiPath.Workflow</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>WindowsFormsIntegration</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Formatters</AssemblyReference>
      <AssemblyReference>System.Private.DataContractSerialization</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Primitives</AssemblyReference>
      <AssemblyReference>System.Runtime.Numerics</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <StateMachine InitialState="{x:Reference __ReferenceID6}" sap2010:Annotation.AnnotationText="Author: Bob Kiser&#xA;Contact Information: robert.kiser@protiviti.com&#xA;Short Process Description: Generalized Performer for PRO Framework.  A Performer processes transaction(s) from either an Orchestrator Queue, or some other Non QueueItem source.  It can also execute a single iteration of logic when Transactions do not make sense to use." DisplayName="State Map" sap:VirtualizedContainerService.HintSize="1035,1202" sap2010:WorkflowViewState.IdRef="StateMachine_1">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">100,12.5</av:Point>
        <x:Double x:Key="StateContainerWidth">1001</x:Double>
        <x:Double x:Key="StateContainerHeight">1093</x:Double>
        <av:PointCollection x:Key="ConnectorLocation">130,87.5 130,117</av:PointCollection>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <State x:Name="__ReferenceID0" sap2010:Annotation.AnnotationText="Get next Transaction and initialize all variables and custom log fields dependent on Transaction data.  Gets transaction from dt_Report depending on the Performer Type.  Will transition to Finalize Job if Transaction cannot be retrieved or if a Stop Signal is retrieved from Orchestrator." DisplayName="Initialize Transaction" sap:VirtualizedContainerService.HintSize="251,203" sap2010:WorkflowViewState.IdRef="State_4">
      <State.Entry>
        <Sequence DisplayName="Initialize Transaction Sequence" sap:VirtualizedContainerService.HintSize="838,2099" sap2010:WorkflowViewState.IdRef="Sequence_25">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke StartState workflow" sap:VirtualizedContainerService.HintSize="776,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_28" UnSafe="False" WorkflowFileName="Framework\State_Start.xaml">
            <ui:InvokeWorkflowFile.Arguments>
              <InArgument x:TypeArguments="x:String" x:Key="in_StateName">Initialize Transaction</InArgument>
              <OutArgument x:TypeArguments="s:DateTime" x:Key="out_StateStart">[tsp_StateStart]</OutArgument>
              <OutArgument x:TypeArguments="x:String" x:Key="out_StateName">[str_State]</OutArgument>
            </ui:InvokeWorkflowFile.Arguments>
          </ui:InvokeWorkflowFile>
          <TryCatch DisplayName="Try Catch Initialize Transaction" sap:VirtualizedContainerService.HintSize="776,1807" sap2010:WorkflowViewState.IdRef="TryCatch_7">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <TryCatch.Try>
              <Sequence DisplayName="Try Initialize Transaction" sap:VirtualizedContainerService.HintSize="738,1556" sap2010:WorkflowViewState.IdRef="Sequence_41">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:ShouldStop DisplayName="Check Stop Signal" sap:VirtualizedContainerService.HintSize="676,122" sap2010:WorkflowViewState.IdRef="ShouldStop_2" Result="[bln_ShouldStop]" />
                <ui:IfElseIf DisplayName="If no stop signal THEN proceed initialize transaction ELSE stop" sap:VirtualizedContainerService.HintSize="676,1346" sap2010:WorkflowViewState.IdRef="IfElseIf_2">
                  <ui:IfElseIf.ConditionBlocks>
                    <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                      <ui:IfElseIfBlock BlockType="If" Condition="[Not bln_ShouldStop]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_6">
                        <ui:IfElseIfBlock.Then>
                          <Sequence DisplayName="Proceed Initialize Transaction" sap:VirtualizedContainerService.HintSize="625,839" sap2010:WorkflowViewState.IdRef="Sequence_381">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Switch x:TypeArguments="x:String" DisplayName="Switch - Performer Type - Check More Transactions" Expression="[dict_Config(&quot;PerformerType&quot;).ToString.ToUpper]" sap:VirtualizedContainerService.HintSize="563,236" sap2010:WorkflowViewState.IdRef="Switch`1_1">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence x:Key="QI" DisplayName="Switch - QI" sap:VirtualizedContainerService.HintSize="416,168" sap2010:WorkflowViewState.IdRef="Sequence_186">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="GetTransaction_QI.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="354,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_20" UnSafe="False" WorkflowFileName="Framework\Transaction_GetQI.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <OutArgument x:TypeArguments="x:Boolean" x:Key="out_MoreTransactions">[bln_MoreTransactions]</OutArgument>
                                    <OutArgument x:TypeArguments="ui:QueueItem" x:Key="out_QI">[qi_Current]</OutArgument>
                                    <InOutArgument x:TypeArguments="sd:DataTable" x:Key="io_Report">[dt_Report]</InOutArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="in_QueueName">[dict_Config("QueueName").ToString]</InArgument>
                                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Config">[dict_Config]</InArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:InvokeWorkflowFile>
                              </Sequence>
                              <Sequence x:Key="NONQI" DisplayName="Switch NonQI" sap:VirtualizedContainerService.HintSize="416,174" sap2010:WorkflowViewState.IdRef="Sequence_187">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[dt_Report.RowCount &gt; int_TIndex]" DisplayName="If unprocessed transactions THEN Take Off Top ELSE Retrieve" sap:VirtualizedContainerService.HintSize="354,205" sap2010:WorkflowViewState.IdRef="If_76">
                                  <If.Then>
                                    <Sequence DisplayName="Take Off Top" sap:VirtualizedContainerService.HintSize="476,170" sap2010:WorkflowViewState.IdRef="Sequence_196">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_153">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Boolean">[bln_MoreTransactions]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence DisplayName="Retrieve NonQI" sap:VirtualizedContainerService.HintSize="421,201" sap2010:WorkflowViewState.IdRef="Sequence_197">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Framework\Setup_Required\GetTransaction_NonQI.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="379,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_80" UnSafe="False" WorkflowFileName="Framework\Transaction_GetNonQI.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <OutArgument x:TypeArguments="x:Boolean" x:Key="out_MoreTransactions">[bln_MoreTransactions]</OutArgument>
                                          <InOutArgument x:TypeArguments="sd:DataTable" x:Key="io_Report">[dt_Report]</InOutArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </Sequence>
                              <Sequence x:Key="PRELOAD" DisplayName="Switch PreLoad" sap:VirtualizedContainerService.HintSize="416,174" sap2010:WorkflowViewState.IdRef="Sequence_188">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[dt_Report.RowCount &gt; int_TIndex]" DisplayName="If unprocessed transactions THEN Take Off Top ELSE Retrieve" sap:VirtualizedContainerService.HintSize="354,205" sap2010:WorkflowViewState.IdRef="If_77">
                                  <If.Then>
                                    <Sequence DisplayName="Take Off Top" sap:VirtualizedContainerService.HintSize="476,170" sap2010:WorkflowViewState.IdRef="Sequence_198">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_154">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Boolean">[bln_MoreTransactions]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence DisplayName="Retrieve NonQI" sap:VirtualizedContainerService.HintSize="476,170" sap2010:WorkflowViewState.IdRef="Sequence_199">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_185">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Boolean">[bln_MoreTransactions]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </Sequence>
                              <Sequence x:Key="ITERATION" DisplayName="Switch Single Iteration" sap:VirtualizedContainerService.HintSize="496,347" sap2010:WorkflowViewState.IdRef="Sequence_207">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign sap2010:Annotation.AnnotationText="Only set to true on the first iteration of the loop" DisplayName="Assign - bln_MoreTransactions" sap:VirtualizedContainerService.HintSize="434,145" sap2010:WorkflowViewState.IdRef="Assign_159">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Boolean">[bln_MoreTransactions]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:Boolean">[int_TIndex = 0]</InArgument>
                                  </Assign.Value>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </Assign>
                                <Assign sap2010:Annotation.AnnotationText="Set LastTransaction to TRUE, ensuring no loop will happen after Finalize Transaction" DisplayName="Assign - bln_LastTransaction" sap:VirtualizedContainerService.HintSize="434,147" sap2010:WorkflowViewState.IdRef="Assign_160">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Boolean">[bln_LastTransaction]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                  </Assign.Value>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </Assign>
                              </Sequence>
                            </Switch>
                            <ui:IfElseIf DisplayName="If more transactions THEN proceed setup transaction ELSE log" sap:VirtualizedContainerService.HintSize="563,515" sap2010:WorkflowViewState.IdRef="IfElseIf_4">
                              <ui:IfElseIf.ConditionBlocks>
                                <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                  <ui:IfElseIfBlock BlockType="If" Condition="[bln_MoreTransactions]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_4">
                                    <ui:IfElseIfBlock.Then>
                                      <Sequence DisplayName="Proceed Setup Transaction" sap:VirtualizedContainerService.HintSize="512,235" sap2010:WorkflowViewState.IdRef="Sequence_384">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Sequence DisplayName="Setup Transaction Fields and Log Fields" sap:VirtualizedContainerService.HintSize="450,57" sap2010:WorkflowViewState.IdRef="Sequence_64">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:IfElseIf DisplayName="If transaction has no key yet THEN create key" sap:VirtualizedContainerService.HintSize="434,57" sap2010:WorkflowViewState.IdRef="IfElseIf_5">
                                            <ui:IfElseIf.ConditionBlocks>
                                              <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                <ui:IfElseIfBlock BlockType="If" Condition="[dt_Report.Columns.Contains(&quot;T_Key&quot;) AndAlso dt_Report.Rows(int_TIndex)(&quot;T_Key&quot;).ToString = &quot;&quot;]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_1">
                                                  <ui:IfElseIfBlock.Then>
                                                    <Sequence DisplayName="Create Key" sap:VirtualizedContainerService.HintSize="496,193" sap2010:WorkflowViewState.IdRef="Sequence_385">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_146">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_Key")]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_Reference").ToString &amp; "_" &amp; DateTime.Now.ToString("yyMMddHHmmss")]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </Sequence>
                                                  </ui:IfElseIfBlock.Then>
                                                </ui:IfElseIfBlock>
                                              </sc:BindingList>
                                            </ui:IfElseIf.ConditionBlocks>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:IfElseIf>
                                          <ui:IfElseIf DisplayName="If transaction has no source key yet THEN create source key" sap:VirtualizedContainerService.HintSize="434,57" sap2010:WorkflowViewState.IdRef="IfElseIf_6">
                                            <ui:IfElseIf.ConditionBlocks>
                                              <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                <ui:IfElseIfBlock BlockType="If" Condition="[dt_Report.Columns.Contains(&quot;T_SourceKey&quot;) AndAlso dt_Report.Rows(int_TIndex)(&quot;T_SourceKey&quot;).ToString = &quot;&quot;]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_2">
                                                  <ui:IfElseIfBlock.Then>
                                                    <Sequence DisplayName="Create Source Key" sap:VirtualizedContainerService.HintSize="496,193" sap2010:WorkflowViewState.IdRef="Sequence_386">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_147">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_SourceKey")]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_Key").ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </Sequence>
                                                  </ui:IfElseIfBlock.Then>
                                                </ui:IfElseIfBlock>
                                              </sc:BindingList>
                                            </ui:IfElseIf.ConditionBlocks>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:IfElseIf>
                                          <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_197">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="s:DateTime">[tsp_TransactionStart]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="s:DateTime">[DateTime.Now]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <ui:AddLogFields DisplayName="Add Transaction Fields" sap:VirtualizedContainerService.HintSize="434,122" sap2010:WorkflowViewState.IdRef="AddLogFields_13">
                                            <ui:AddLogFields.Fields>
                                              <InArgument x:TypeArguments="x:String" x:Key="Transaction_Reference">[dt_Report.Rows(int_TIndex)("T_Reference").ToString]</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="Transaction_Key">[dt_Report.Rows(int_TIndex)("T_Key").ToString]</InArgument>
                                              <InArgument x:TypeArguments="x:Int32" x:Key="Transaction_Index">[int_TIndex]</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="Transaction_SourceKey">[dt_Report.Rows(int_TIndex)("T_SourceKey").ToString]</InArgument>
                                              <InArgument x:TypeArguments="x:Int32" x:Key="Transaction_RetryNbr">[CInt(dt_Report.Rows(int_TIndex)("T_RetryNbr"))]</InArgument>
                                            </ui:AddLogFields.Fields>
                                          </ui:AddLogFields>
                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,164" sap2010:WorkflowViewState.IdRef="LogMessage_82" Level="Info" Message="[&quot;Transaction successfully added to dt_Report. Key: &quot; &amp; dt_Report.Rows(int_TIndex)(&quot;T_Key&quot;).ToString]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:LogMessage>
                                        </Sequence>
                                        <Sequence sap2010:Annotation.AnnotationText="SETUP REQUIRED - Actions are defaulted to &quot;NOTHING&quot;, actions should be based on your process" DisplayName="Feature - Manage Network Folder" sap:VirtualizedContainerService.HintSize="450,90" sap2010:WorkflowViewState.IdRef="Sequence_315">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:IfElseIf DisplayName="If network folder provided THEN proceed manage network folder" sap:VirtualizedContainerService.HintSize="467,502" sap2010:WorkflowViewState.IdRef="IfElseIf_3">
                                            <ui:IfElseIf.ConditionBlocks>
                                              <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                <ui:IfElseIfBlock BlockType="If" Condition="[dict_Config(&quot;NetworkFolder&quot;).ToString &lt;&gt; &quot;&quot;]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_3">
                                                  <ui:IfElseIfBlock.Then>
                                                    <Sequence DisplayName="Proceed Manage Network Folder" sap:VirtualizedContainerService.HintSize="416,283" sap2010:WorkflowViewState.IdRef="Sequence_383">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\ManageNetworkFolder.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="354,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_107" UnSafe="False" WorkflowFileName="Framework\NetworkFolder_Manage.xaml">
                                                        <ui:InvokeWorkflowFile.Arguments>
                                                          <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="io_Config">[dict_Config]</InOutArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_Key">[dt_Report.Rows(int_TIndex)("T_Key").ToString]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_Action">CREATE</InArgument>
                                                        </ui:InvokeWorkflowFile.Arguments>
                                                      </ui:InvokeWorkflowFile>
                                                    </Sequence>
                                                  </ui:IfElseIfBlock.Then>
                                                </ui:IfElseIfBlock>
                                              </sc:BindingList>
                                            </ui:IfElseIf.ConditionBlocks>
                                          </ui:IfElseIf>
                                        </Sequence>
                                      </Sequence>
                                    </ui:IfElseIfBlock.Then>
                                  </ui:IfElseIfBlock>
                                  <ui:IfElseIfBlock BlockType="Else" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_5">
                                    <ui:IfElseIfBlock.Then>
                                      <Sequence DisplayName="Log No More Transactions" sap:VirtualizedContainerService.HintSize="416,25" sap2010:WorkflowViewState.IdRef="Sequence_387">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="388,141" sap2010:WorkflowViewState.IdRef="LogMessage_52" Level="Info" Message="[&quot;No more transactions left to be processed&quot;]" />
                                      </Sequence>
                                    </ui:IfElseIfBlock.Then>
                                  </ui:IfElseIfBlock>
                                </sc:BindingList>
                              </ui:IfElseIf.ConditionBlocks>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:IfElseIf>
                          </Sequence>
                        </ui:IfElseIfBlock.Then>
                      </ui:IfElseIfBlock>
                      <ui:IfElseIfBlock BlockType="Else" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_7">
                        <ui:IfElseIfBlock.Then>
                          <Sequence DisplayName="Stop Signal Received" sap:VirtualizedContainerService.HintSize="416,252" sap2010:WorkflowViewState.IdRef="Sequence_382">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="354,164" sap2010:WorkflowViewState.IdRef="LogMessage_27" Level="Warn" Message="[&quot;Stop Process requested from Orchestrator.  Stopping...&quot;]" />
                          </Sequence>
                        </ui:IfElseIfBlock.Then>
                      </ui:IfElseIfBlock>
                    </sc:BindingList>
                  </ui:IfElseIf.ConditionBlocks>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:IfElseIf>
              </Sequence>
            </TryCatch.Try>
            <TryCatch.Catches>
              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="742,22" sap2010:WorkflowViewState.IdRef="Catch`1_8">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="s:Exception">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="s:Exception" Name="Exception" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Initialize Transaction Exception" sap:VirtualizedContainerService.HintSize="496,366" sap2010:WorkflowViewState.IdRef="Sequence_24">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="434,173" sap2010:WorkflowViewState.IdRef="LogMessage_54" Level="Error" Message="[str_State &amp; &quot; State Failed: &quot; &amp; exception.Message]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:LogMessage>
                    <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_40">
                      <Assign.To>
                        <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="s:Exception">[Exception]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </Sequence>
                </ActivityAction>
              </Catch>
            </TryCatch.Catches>
          </TryCatch>
        </Sequence>
      </State.Entry>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">4.5,442.5</av:Point>
          <av:Size x:Key="ShapeSize">251,203</av:Size>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <x:Double x:Key="StateContainerWidth">217</x:Double>
          <x:Double x:Key="StateContainerHeight">34</x:Double>
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State.Exit>
        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke EndState workflow" sap:VirtualizedContainerService.HintSize="334,172" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_29" UnSafe="False" WorkflowFileName="Framework\State_End.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="x:String" x:Key="in_LeavingState">[str_State]</InArgument>
            <InArgument x:TypeArguments="s:DateTime" x:Key="in_StateStart">[tsp_StateStart]</InArgument>
          </ui:InvokeWorkflowFile.Arguments>
        </ui:InvokeWorkflowFile>
      </State.Exit>
      <State.Transitions>
        <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="585,510" sap2010:WorkflowViewState.IdRef="Transition_15">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:PointCollection x:Key="ConnectorLocation">130,645.5 130,882</av:PointCollection>
              <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <State x:Name="__ReferenceID2" sap2010:Annotation.AnnotationText="Process a single Transaction or Iteration.  Monitors for long running transactions.&#xA;" DisplayName="Execute Process" sap:VirtualizedContainerService.HintSize="233,146" sap2010:WorkflowViewState.IdRef="State_3">
              <State.Entry>
                <TryCatch DisplayName="Try Catch Process Logic" sap:VirtualizedContainerService.HintSize="1348,1617" sap2010:WorkflowViewState.IdRef="TryCatch_20">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <Sequence DisplayName="Try Process Logic" sap:VirtualizedContainerService.HintSize="1310,1389" sap2010:WorkflowViewState.IdRef="Sequence_226">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke StartState" sap:VirtualizedContainerService.HintSize="1248,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_86" UnSafe="False" WorkflowFileName="Framework\State_Start.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <InArgument x:TypeArguments="x:String" x:Key="in_StateName">Process Logic</InArgument>
                          <OutArgument x:TypeArguments="s:DateTime" x:Key="out_StateStart">[tsp_StateStart]</OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="out_StateName">[str_State]</OutArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                      </ui:InvokeWorkflowFile>
                      <Sequence sap2010:Annotation.AnnotationText="There are 3 options for the Main Execution section of Process Logic&#xA;1. Uncomment Invoke ProcessIteration within Parallel&#xA;2. Uncomment Invoke ProcessTransaction within Parallel&#xA;3. Remove Parallel completely and replace with upper most Try/Catch from DU _Template" DisplayName="Main Execution" sap:VirtualizedContainerService.HintSize="1248,1097" sap2010:WorkflowViewState.IdRef="Sequence_332">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Parallel DisplayName="Parallel - Handle Long Running Transaction or Iteration" sap:VirtualizedContainerService.HintSize="1186,866" sap2010:WorkflowViewState.IdRef="Parallel_3">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Parallel.CompletionCondition>True</Parallel.CompletionCondition>
                          <Sequence DisplayName="Check For Long Running Transaction" sap:VirtualizedContainerService.HintSize="536,787" sap2010:WorkflowViewState.IdRef="Sequence_210">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\DelayThread.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="434,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_109" UnSafe="True" WorkflowFileName="Framework\Thread_Delay.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:TimeSpan" x:Key="in_Delay">[TimeSpan.FromMinutes(CDBL(dict_Config("LongRunning_MaxMinutes")))]</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                            <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_161">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:Boolean">[bln_LongRunning]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                              </Assign.Value>
                            </Assign>
                          </Sequence>
                          <Sequence DisplayName="Process Transaction or Iteration" sap:VirtualizedContainerService.HintSize="556,787" sap2010:WorkflowViewState.IdRef="Sequence_216">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <TryCatch DisplayName="Try Catch Process Transaction or Iteration" sap:VirtualizedContainerService.HintSize="454,699" sap2010:WorkflowViewState.IdRef="TryCatch_21">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <TryCatch.Try>
                                <Sequence DisplayName="Try Process Transaction or Iteration" sap:VirtualizedContainerService.HintSize="416,448" sap2010:WorkflowViewState.IdRef="Sequence_211">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="sd:DataTable" Name="dt_ReportDetailsTemp" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ProcessTransaction_Main.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="354,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_113" Level="Trace" LogEntry="WithArguments" LogExit="WithArguments" UnSafe="False" WorkflowFileName="Framework\Transaction_Execute.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <OutArgument x:TypeArguments="ui:Image" x:Key="out_ExceptionScreenshot">[img_ExceptionScreenshot]</OutArgument>
                                      <OutArgument x:TypeArguments="s:Exception" x:Key="out_Exception">[ex_Exception]</OutArgument>
                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Config">[dict_Config]</InArgument>
                                      <InOutArgument x:TypeArguments="sd:DataTable" x:Key="io_Report">[dt_Report]</InOutArgument>
                                      <InArgument x:TypeArguments="x:Int32" x:Key="in_TIndex">[int_TIndex]</InArgument>
                                      <InArgument x:TypeArguments="ui:QueueItem" x:Key="in_QueueItem" />
                                      <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_ReportDetails">[dt_ReportDetailsTemp]</OutArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                  <ui:MergeDataTable Destination="[dt_ReportDetails]" DisplayName="Merge Data Table" sap:VirtualizedContainerService.HintSize="354,156" sap2010:WorkflowViewState.IdRef="MergeDataTable_6" MissingSchemaAction="Add" Source="[dt_ReportDetailsTemp]" />
                                </Sequence>
                              </TryCatch.Try>
                              <TryCatch.Catches>
                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="420,22" sap2010:WorkflowViewState.IdRef="Catch`1_20">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ActivityAction x:TypeArguments="s:Exception">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Catch Process Transaction or Iteration" sap:VirtualizedContainerService.HintSize="496,366" sap2010:WorkflowViewState.IdRef="Sequence_212">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,173" sap2010:WorkflowViewState.IdRef="LogMessage_89" Level="Error" Message="[&quot;Process Transaction or Iteration Threw Exception: &quot; &amp; exception.Message]" />
                                      <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_162">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </ActivityAction>
                                </Catch>
                              </TryCatch.Catches>
                            </TryCatch>
                          </Sequence>
                        </Parallel>
                        <Sequence DisplayName="Handle Long Running and Exception" sap:VirtualizedContainerService.HintSize="1186,48" sap2010:WorkflowViewState.IdRef="Sequence_221">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If Condition="[bln_LongRunning]" DisplayName="If Long Running THEN Handle Long Running ELSE Normal" sap:VirtualizedContainerService.HintSize="626,1990" sap2010:WorkflowViewState.IdRef="If_89">
                            <If.Then>
                              <Sequence DisplayName="Handle Long Running" sap:VirtualizedContainerService.HintSize="592,1276" sap2010:WorkflowViewState.IdRef="Sequence_218">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="530,173" sap2010:WorkflowViewState.IdRef="LogMessage_90" Level="Error" Message="[&quot;Process Transaction or Iteration exceeded max allowed runtime of &quot; &amp; dict_Config(&quot;LongRunning_MaxMinutes&quot;).ToString &amp; &quot; minutes.&quot;]" />
                                <If Condition="[CBOOL(dict_Config(&quot;LongRunning_ForceLast&quot;))]" DisplayName="If Long Running items should exit loop THEN Last Item" sap:VirtualizedContainerService.HintSize="530,466" sap2010:WorkflowViewState.IdRef="If_87">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Sequence DisplayName="Make Last Item" sap:VirtualizedContainerService.HintSize="496,193" sap2010:WorkflowViewState.IdRef="Sequence_217">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_165">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Boolean">[bln_LastTransaction]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_236">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </Sequence>
                                  </If.Else>
                                </If>
                                <ui:RaiseAlert DisplayName="Raise Alert" sap:VirtualizedContainerService.HintSize="530,223" sap2010:WorkflowViewState.IdRef="RaiseAlert_5" Notification="[&quot;Process Transaction or Iteration exceeded max allowed runtime of &quot; &amp; dict_Config(&quot;LongRunning_MaxMinutes&quot;).ToString &amp; &quot; minutes.&quot;]" Severity="Warning">
                                  <ui:RaiseAlert.TimeoutMS>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:RaiseAlert.TimeoutMS>
                                </ui:RaiseAlert>
                                <uix:NTakeScreenshot DisplayName="Take Screenshot" FileNameMode="None" sap:VirtualizedContainerService.HintSize="530,213" sap2010:WorkflowViewState.IdRef="NTakeScreenshot_6" OutImage="[img_ExceptionScreenshot]" SaveScreenshotTo="Image" Version="V3" />
                                <Throw Exception="[New SystemException(&quot;Process Transaction Main exceeded max allowed runtime of &quot; &amp; dict_Config(&quot;LongRunning_MaxMinutes&quot;).ToString &amp; &quot; minutes.&quot;)]" sap:VirtualizedContainerService.HintSize="530,113" sap2010:WorkflowViewState.IdRef="Throw_5" />
                              </Sequence>
                            </If.Then>
                            <If.Else>
                              <Sequence DisplayName="Normal Path" sap:VirtualizedContainerService.HintSize="512,553" sap2010:WorkflowViewState.IdRef="Sequence_220">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[ex_Exception IsNot Nothing]" DisplayName="If Process Transaction or Iteration threw exception THEN Throw" sap:VirtualizedContainerService.HintSize="450,465" sap2010:WorkflowViewState.IdRef="If_88">
                                  <If.Then>
                                    <Sequence DisplayName="Throw Process Transaction or Iteration Exception" sap:VirtualizedContainerService.HintSize="416,201" sap2010:WorkflowViewState.IdRef="Sequence_219">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Throw Exception="[ex_Exception]" sap:VirtualizedContainerService.HintSize="354,113" sap2010:WorkflowViewState.IdRef="Throw_6" />
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_239">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </Sequence>
                            </If.Else>
                          </If>
                        </Sequence>
                      </Sequence>
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1314,22" sap2010:WorkflowViewState.IdRef="Catch`1_21">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Process Logic Exception" sap:VirtualizedContainerService.HintSize="496,366" sap2010:WorkflowViewState.IdRef="Sequence_227">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="434,173" sap2010:WorkflowViewState.IdRef="LogMessage_91" Level="Error" Message="[str_State &amp; &quot; State Failed: &quot; + exception.Message]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                          <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_167">
                            <Assign.To>
                              <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
              </State.Entry>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">13.5,882</av:Point>
                  <av:Size x:Key="ShapeSize">233,146</av:Size>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Double x:Key="StateContainerWidth">198.9498035339633</x:Double>
                  <x:Double x:Key="StateContainerHeight">36.78234994916488</x:Double>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <State.Exit>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke EndState workflow" sap:VirtualizedContainerService.HintSize="334,172" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_36" UnSafe="False" WorkflowFileName="Framework\State_End.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="in_LeavingState">[str_State]</InArgument>
                    <InArgument x:TypeArguments="s:DateTime" x:Key="in_StateStart">[tsp_StateStart]</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
              </State.Exit>
              <State.Transitions>
                <Transition DisplayName="Always" sap:VirtualizedContainerService.HintSize="450,510" sap2010:WorkflowViewState.IdRef="Transition_8">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:PointCollection x:Key="ConnectorLocation">246.5,955 276.5,955 276.5,947.4 416.5,947.4</av:PointCollection>
                      <x:Int32 x:Key="SrcConnectionPointIndex">36</x:Int32>
                      <x:Int32 x:Key="DestConnectionPointIndex">53</x:Int32>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Transition.To>
                    <State x:Name="__ReferenceID3" sap2010:Annotation.AnnotationText="Update transaction in dt_Report and Orchestrator with success or failure of Transaction.  Retry Transaction if applicable.  Checks if consecutive System Exceptions are met.  Handles automatic screenshots." DisplayName="Finalize Transaction" sap:VirtualizedContainerService.HintSize="251,172" sap2010:WorkflowViewState.IdRef="State_6">
                      <State.Entry>
                        <TryCatch DisplayName="Try Catch Finalize Transaction" sap:VirtualizedContainerService.HintSize="962,5410" sap2010:WorkflowViewState.IdRef="TryCatch_15">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <TryCatch.Try>
                            <Sequence DisplayName="Try Finalize Transaction" sap:VirtualizedContainerService.HintSize="924,5183" sap2010:WorkflowViewState.IdRef="Sequence_32">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke StartState workflow" sap:VirtualizedContainerService.HintSize="862,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_37" UnSafe="False" WorkflowFileName="Framework\State_Start.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_StateName">Finalize Transaction</InArgument>
                                  <OutArgument x:TypeArguments="s:DateTime" x:Key="out_StateStart">[tsp_StateStart]</OutArgument>
                                  <OutArgument x:TypeArguments="x:String" x:Key="out_StateName">[str_State]</OutArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                              <If Condition="[Not (dict_Config.ContainsKey(&quot;PerformerType&quot;) AndAlso dict_Config(&quot;PerformerType&quot;).ToString.ToUpper = &quot;ITERATION&quot;)]" DisplayName="If not single iteration THEN Finalize Transaction" sap:VirtualizedContainerService.HintSize="862,4891" sap2010:WorkflowViewState.IdRef="If_84">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Finalize Transaction" sap:VirtualizedContainerService.HintSize="828,4567" sap2010:WorkflowViewState.IdRef="Sequence_208">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence DisplayName="Set Transaction Status and Retry" sap:VirtualizedContainerService.HintSize="766,3612" sap2010:WorkflowViewState.IdRef="Sequence_113">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:MultipleAssign sap2010:Annotation.AnnotationText="T_Success&#xA;T_LastModTsp&#xA;T_ExecutionSeconds" DisplayName="Update dt_Report Tech Fields for Transaction" sap:VirtualizedContainerService.HintSize="704,267" sap2010:WorkflowViewState.IdRef="MultipleAssign_5">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_27">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_Success")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">[ex_Exception Is Nothing]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_28">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_LastModTsp")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">[DateTime.Now]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_56">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_ExecutionSeconds")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Double">[CInt(dt_Report.Rows(int_TIndex)("T_ExecutionSeconds")) + (DateTime.Now - tsp_TransactionStart).TotalSeconds]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:MultipleAssign>
                                      <If Condition="[dict_Config(&quot;PerformerType&quot;) = &quot;QI&quot; AndAlso dict_Config.ContainsKey(&quot;QI_ProgressColumns&quot;) AndAlso dict_Config(&quot;QI_ProgressColumns&quot;) &lt;&gt; &quot;&quot;]" DisplayName="If transaction is QI THEN update progress" sap:VirtualizedContainerService.HintSize="704,57" sap2010:WorkflowViewState.IdRef="If_118">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Sequence sap:VirtualizedContainerService.HintSize="376,266" sap2010:WorkflowViewState.IdRef="Sequence_376">
                                            <Sequence.Variables>
                                              <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Default="[New Dictionary(Of String, String)]" Name="dict_Temp" />
                                            </Sequence.Variables>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each - Column in Config" sap:VirtualizedContainerService.HintSize="334,25" sap2010:WorkflowViewState.IdRef="ForEach`1_1" Values="[dict_Config(&quot;QI_ProgressColumns&quot;).Split(&quot;,&quot;)]">
                                              <ui:ForEach.Body>
                                                <ActivityAction x:TypeArguments="x:String">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:String" Name="curCol" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="552,440" sap2010:WorkflowViewState.IdRef="Sequence_378">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[dt_Report.Columns.Contains(curCol)]" DisplayName="If dt_Report has that column THEN add to temp dictionary" sap:VirtualizedContainerService.HintSize="510,352" sap2010:WorkflowViewState.IdRef="If_119">
                                                      <If.Then>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="476,170" sap2010:WorkflowViewState.IdRef="Sequence_379">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_184">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[dict_Temp(curCol)]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[dt_Report.Rows(int_TIndex)(curCol).ToString]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                      </If.Then>
                                                      <If.Else>
                                                        <Sequence sap2010:WorkflowViewState.IdRef="Sequence_380" />
                                                      </If.Else>
                                                    </If>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:ForEach.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ForEach>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\Transaction_UpdateProgress.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_110" UnSafe="False" WorkflowFileName="Framework\QueueItem_UpdateProgress.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="ui:QueueItem" x:Key="in_QueueItem">[qi_Current]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_Key" />
                                                <InArgument x:TypeArguments="x:String" x:Key="in_Value" />
                                                <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_BulkValues">[dict_Temp]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_377">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </Sequence>
                                        </If.Else>
                                      </If>
                                      <If Condition="[CBool(dt_Report.Rows(int_TIndex)(&quot;T_Success&quot;))]" DisplayName="If transaction successful THEN Successful Status ELSE Failed Status" sap:VirtualizedContainerService.HintSize="704,3168" sap2010:WorkflowViewState.IdRef="If_17">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Sequence DisplayName="Successfull Status" sap:VirtualizedContainerService.HintSize="416,25" sap2010:WorkflowViewState.IdRef="Sequence_53">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If Condition="[dict_Config(&quot;PerformerType&quot;).ToString = &quot;QI&quot;]" DisplayName="If PerformerType is QI THEN Update QueueItem" sap:VirtualizedContainerService.HintSize="434,722" sap2010:WorkflowViewState.IdRef="If_70">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <Sequence DisplayName="Update QueueItem" sap:VirtualizedContainerService.HintSize="376,460" sap2010:WorkflowViewState.IdRef="Sequence_181">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,141" sap2010:WorkflowViewState.IdRef="LogMessage_61" Level="Info" Message="[&quot;Marking QueueItem &quot; &amp; qi_Current.Reference &amp; &quot; as Successful in Orchestrator...&quot;]" />
                                                  <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" Details="[dict_Config(&quot;OrchURL&quot;).ToString &amp; &quot;jobs/&quot; &amp; dict_Config(&quot;JobID&quot;).ToString &amp; &quot;/&quot;]" DisplayName="Set Transaction Status" ErrorType="Application" sap:VirtualizedContainerService.HintSize="334,191" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_1" Status="Successful" TransactionItem="[qi_Current]">
                                                    <ui:SetTransactionStatus.Analytics>
                                                      <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                    </ui:SetTransactionStatus.Analytics>
                                                    <ui:SetTransactionStatus.Output>
                                                      <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                    </ui:SetTransactionStatus.Output>
                                                    <ui:SetTransactionStatus.Reason>
                                                      <InArgument x:TypeArguments="x:String" />
                                                    </ui:SetTransactionStatus.Reason>
                                                    <ui:SetTransactionStatus.TimeoutMS>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:SetTransactionStatus.TimeoutMS>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:SetTransactionStatus>
                                                </Sequence>
                                              </If.Then>
                                              <If.Else>
                                                <Sequence DisplayName="" sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_296">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </Sequence>
                                              </If.Else>
                                            </If>
                                            <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_89">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Int32">[int_ConsecutiveSE]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_141">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_ExceptionMessage")]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <Sequence DisplayName="Failed Status" sap:VirtualizedContainerService.HintSize="670,2982" sap2010:WorkflowViewState.IdRef="Sequence_54">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If Condition="[ex_Exception.GetType.ToString.Contains(&quot;Business&quot;)]" DisplayName="If ExceptionType contains Business THEN Business Exception ELSE System Exception" sap:VirtualizedContainerService.HintSize="608,2894" sap2010:WorkflowViewState.IdRef="If_18">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <Sequence DisplayName="Business Exception" sap:VirtualizedContainerService.HintSize="750,4240" sap2010:WorkflowViewState.IdRef="Sequence_55">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If Condition="[dict_Config(&quot;PerformerType&quot;).ToString = &quot;QI&quot;]" DisplayName="If PerformerType is QI THEN Update Orchestrator" sap:VirtualizedContainerService.HintSize="688,799" sap2010:WorkflowViewState.IdRef="If_71">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <Sequence DisplayName="Set Orchestrator Status - Business" sap:VirtualizedContainerService.HintSize="416,526" sap2010:WorkflowViewState.IdRef="Sequence_183">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,173" sap2010:WorkflowViewState.IdRef="LogMessage_62" Level="Info" Message="[&quot;Marking QueueItem &quot; &amp; qi_Current.Reference &amp; &quot; as a BusinessException in Orchestrator...&quot;]" />
                                                        <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" Details="[dict_Config(&quot;OrchURL&quot;).ToString &amp; &quot;jobs/&quot; &amp; dict_Config(&quot;JobID&quot;).ToString &amp; &quot;/logs&quot; &amp; &quot; ; &quot; &amp; _&#xA;&quot;Transaction: &quot; &amp; int_TIndex+1 &amp; &quot;/&quot; &amp; dt_Report.RowCount]" DisplayName="Set Transaction Status" ErrorType="Business" sap:VirtualizedContainerService.HintSize="354,265" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_2" Reason="[ex_Exception.Message]" Status="Failed" TransactionItem="[qi_Current]">
                                                          <ui:SetTransactionStatus.Analytics>
                                                            <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                          </ui:SetTransactionStatus.Analytics>
                                                          <ui:SetTransactionStatus.Output>
                                                            <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                          </ui:SetTransactionStatus.Output>
                                                          <ui:SetTransactionStatus.TimeoutMS>
                                                            <InArgument x:TypeArguments="x:Int32" />
                                                          </ui:SetTransactionStatus.TimeoutMS>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:SetTransactionStatus>
                                                      </Sequence>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_297">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                  <Assign sap:VirtualizedContainerService.HintSize="688,114" sap2010:WorkflowViewState.IdRef="Assign_90">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[int_ConsecutiveSE]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <Sequence DisplayName="Set Exception Fields" sap:VirtualizedContainerService.HintSize="688,339" sap2010:WorkflowViewState.IdRef="Sequence_87">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Assign DisplayName="ExceptionType" sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_65">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_ExceptionType")]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Object">["BusinessException"]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <Assign DisplayName="ExceptionMessage" sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_66">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_ExceptionMessage")]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Object">[ex_Exception.Message]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </Sequence>
                                                  <Sequence DisplayName="Retry QueueItem" sap:VirtualizedContainerService.HintSize="688,2839" sap2010:WorkflowViewState.IdRef="Sequence_112">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[CBOOL(dt_Report.Rows(int_TIndex)(&quot;T_CanRetry&quot;)) And CINT(dt_Report.Rows(int_TIndex)(&quot;T_RetryNbr&quot;)) &lt; CINT(dict_Config(&quot;Retry_MaxRetries&quot;))]" DisplayName="If Transaction can be retried THEN Retry Transaction" sap:VirtualizedContainerService.HintSize="626,2719" sap2010:WorkflowViewState.IdRef="If_40">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <Sequence DisplayName="Retry Transaction" sap:VirtualizedContainerService.HintSize="592,2538" sap2010:WorkflowViewState.IdRef="Sequence_105">
                                                          <Sequence.Variables>
                                                            <Variable x:TypeArguments="scg:Dictionary(x:String, x:Object)" Default="[new Dictionary(Of String, Object)]" Name="dict_RetrySpecificContent" />
                                                            <Variable x:TypeArguments="x:String" Name="str_RetryReference" />
                                                          </Sequence.Variables>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="530,173" sap2010:WorkflowViewState.IdRef="LogMessage_63" Level="Info" Message="[&quot;Attempting to retry Transaction...&quot;]" />
                                                          <Assign sap:VirtualizedContainerService.HintSize="530,114" sap2010:WorkflowViewState.IdRef="Assign_75">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_RetryReference]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[dt_Report.Rows(int_TIndex)("T_Reference").ToString.Split("_Retry")(0) &amp; "_Retry(" &amp; (CINT(dt_Report.Rows(int_TIndex)("T_RetryNbr")) + 1).ToString &amp; ")"]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <If Condition="[dict_Config(&quot;PerformerType&quot;).ToString = &quot;QI&quot;]" DisplayName="If PerformerType is QI THEN Retry QI ELSE Retry Transaction" sap:VirtualizedContainerService.HintSize="530,2071" sap2010:WorkflowViewState.IdRef="If_69">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Then>
                                                              <Sequence DisplayName="Retry QI" sap:VirtualizedContainerService.HintSize="476,829" sap2010:WorkflowViewState.IdRef="Sequence_179">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,141" sap2010:WorkflowViewState.IdRef="LogMessage_86" Level="Info" Message="[&quot;Attempting to retry QueueItem &quot; &amp; qi_Current.Reference &amp; &quot; by making a duplicate and postponing it &quot; &amp; dict_Config(&quot;Retry_PostponeMinutes&quot;).ToString &amp; &quot; minutes in Orchestrator...&quot;]" />
                                                                <Assign DisplayName="Duplicate Specific Content" sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_73">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)">[dict_RetrySpecificContent]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)">[qi_Current.SpecificContent]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign DisplayName="Increase Retry Nbr" sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_74">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[dict_RetrySpecificContent("RetryNbr")]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[CINT(dt_Report.Rows(int_TIndex)("T_RetryNbr")) + 1]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign DisplayName="Set SourceKey" sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_135">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[dict_RetrySpecificContent("SourceKey")]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_Key").ToString]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <ui:AddQueueItem ServiceBaseAddress="{x:Null}" DeferDate="[Now.AddMinutes(CINT(dict_Config(&quot;Retry_PostponeMinutes&quot;)))]" DisplayName="Add Queue Item" sap:VirtualizedContainerService.HintSize="434,194" sap2010:WorkflowViewState.IdRef="AddQueueItem_1" ItemInformationCollection="[dict_RetrySpecificContent]" Priority="Low" QueueType="[dict_Config(&quot;QueueName&quot;).ToString]" Reference="[str_RetryReference]">
                                                                  <ui:AddQueueItem.ItemInformation>
                                                                    <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                                  </ui:AddQueueItem.ItemInformation>
                                                                  <ui:AddQueueItem.TimeoutMS>
                                                                    <InArgument x:TypeArguments="x:Int32" />
                                                                  </ui:AddQueueItem.TimeoutMS>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:AddQueueItem>
                                                              </Sequence>
                                                            </If.Then>
                                                            <If.Else>
                                                              <Sequence DisplayName="Retry NonQI Transaction" sap:VirtualizedContainerService.HintSize="496,1072" sap2010:WorkflowViewState.IdRef="Sequence_180">
                                                                <Sequence.Variables>
                                                                  <Variable x:TypeArguments="s:Object[]" Name="obj_Temp_List" />
                                                                </Sequence.Variables>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_136">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="s:Object[]">[obj_Temp_List]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="s:Object[]">[dt_Report.Rows(int_TIndex).ItemArray]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign DisplayName="Update Reference" sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_158">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[obj_Temp_List(dt_Report.Columns("Reference").Ordinal)]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[str_RetryReference]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign DisplayName="Update Key" sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_145">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[obj_Temp_List(dt_Report.Columns("Key").Ordinal)]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_Reference").ToString &amp; "_" &amp; DateTime.Now.ToString("yyMMddHHmmss")]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign DisplayName="Increase Retry Nbr" sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_137">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[obj_Temp_List(dt_Report.Columns("T_RetryNbr").Ordinal)]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[CINT(dt_Report.Rows(int_TIndex)("T_RetryNbr")) + 1]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign DisplayName="Set Success" sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_142">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[obj_Temp_List(dt_Report.Columns("T_Success").Ordinal)]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[False]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign DisplayName="Set T_LastMilestone" sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_144">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[obj_Temp_List(dt_Report.Columns("T_LastMilestone").Ordinal)]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">["Retry - Not Yet Attempted"]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign DisplayName="Set ExceptionType" sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_149">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[obj_Temp_List(dt_Report.Columns("T_ExceptionType").Ordinal)]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[obj_Temp_List]" DataTable="[dt_Report]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="434,186" sap2010:WorkflowViewState.IdRef="AddDataRow_5" />
                                                              </Sequence>
                                                            </If.Else>
                                                          </If>
                                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="478,92" sap2010:WorkflowViewState.IdRef="LogMessage_65" Level="Info" Message="[&quot;Duplicate transaction successfully created and marked for retry. Reference: &quot; &amp; str_RetryReference]" />
                                                        </Sequence>
                                                      </If.Then>
                                                      <If.Else>
                                                        <Sequence DisplayName="Else" sap2010:WorkflowViewState.IdRef="Sequence_298" />
                                                      </If.Else>
                                                    </If>
                                                  </Sequence>
                                                  <Assign sap:VirtualizedContainerService.HintSize="680,61" sap2010:WorkflowViewState.IdRef="Assign_130">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                </Sequence>
                                              </If.Then>
                                              <If.Else>
                                                <Sequence DisplayName="SystemException" sap:VirtualizedContainerService.HintSize="574,2708" sap2010:WorkflowViewState.IdRef="Sequence_56">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If Condition="[dict_Config(&quot;PerformerType&quot;).ToString = &quot;QI&quot;]" DisplayName="If PerformerType is QI THEN Update QueueItem" sap:VirtualizedContainerService.HintSize="512,799" sap2010:WorkflowViewState.IdRef="If_72">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <Sequence DisplayName="Update QueueItem - SE" sap:VirtualizedContainerService.HintSize="416,526" sap2010:WorkflowViewState.IdRef="Sequence_184">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,173" sap2010:WorkflowViewState.IdRef="LogMessage_64" Level="Info" Message="[&quot;Marking Transaction &quot; &amp; qi_Current.Reference &amp; &quot; as a SystemException in Orchestrator...&quot;]" />
                                                        <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" Details="[dict_Config(&quot;OrchURL&quot;).ToString &amp; &quot;jobs/&quot; &amp; dict_Config(&quot;JobID&quot;).ToString &amp; &quot;/logs&quot; &amp; &quot; ; &quot; &amp; _&#xA;&quot;Transaction: &quot; &amp; int_TIndex+1 &amp; &quot;/&quot; &amp; dt_Report.RowCount &amp; &quot; ; &quot; &amp; _&#xA;&quot;Consecutive SE: &quot; &amp; int_ConsecutiveSE &amp; &quot; / &quot; &amp; dict_Config(&quot;ConsecutiveSE_TerminateJob&quot;).ToString]" DisplayName="Set Transaction Status" ErrorType="Application" sap:VirtualizedContainerService.HintSize="354,265" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_3" Reason="[ex_Exception.Message]" Status="Failed" TransactionItem="[qi_Current]">
                                                          <ui:SetTransactionStatus.Analytics>
                                                            <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                          </ui:SetTransactionStatus.Analytics>
                                                          <ui:SetTransactionStatus.Output>
                                                            <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                          </ui:SetTransactionStatus.Output>
                                                          <ui:SetTransactionStatus.TimeoutMS>
                                                            <InArgument x:TypeArguments="x:Int32" />
                                                          </ui:SetTransactionStatus.TimeoutMS>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:SetTransactionStatus>
                                                      </Sequence>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_299">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                  <Assign sap:VirtualizedContainerService.HintSize="512,114" sap2010:WorkflowViewState.IdRef="Assign_88">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[int_ConsecutiveSE]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Int32">[int_ConsecutiveSE + 1]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <Assign sap:VirtualizedContainerService.HintSize="512,114" sap2010:WorkflowViewState.IdRef="Assign_183">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[int_MostConsecutiveSE]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Int32">[Math.Max(int_MostConsecutiveSE,int_ConsecutiveSE)]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="512,173" sap2010:WorkflowViewState.IdRef="LogMessage_74" Level="Info" Message="[&quot;Consecutive SystemExceptions: &quot; &amp; int_ConsecutiveSE &amp; &quot; / &quot; &amp; dict_Config(&quot;ConsecutiveSE_TerminateJob&quot;).ToString]" />
                                                  <Sequence DisplayName="Set Exception Fields" sap:VirtualizedContainerService.HintSize="512,339" sap2010:WorkflowViewState.IdRef="Sequence_88">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Assign DisplayName="T_ExceptionType" sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_67">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_ExceptionType")]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Object">["SystemException"]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <Assign DisplayName="T_ExceptionMessage" sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_68">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Object">[dt_Report.Rows(int_TIndex)("T_ExceptionMessage")]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Object">[ex_Exception.Message]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </Sequence>
                                                  <Sequence DisplayName="Handle Open Windows" sap:VirtualizedContainerService.HintSize="512,346" sap2010:WorkflowViewState.IdRef="Sequence_232">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Log open windows" DisplayName="Utilities\GetOpenWindows.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="388,226" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_92" UnSafe="False" WorkflowFileName="Framework\Applications_GetOpenWindows.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_Windows" />
                                                        <InArgument x:TypeArguments="x:Boolean" x:Key="in_WriteToLog">True</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:InvokeWorkflowFile>
                                                  </Sequence>
                                                  <Sequence DisplayName="Handle Screenshot" sap:VirtualizedContainerService.HintSize="512,653" sap2010:WorkflowViewState.IdRef="Sequence_133">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[img_ExceptionScreenshot Is Nothing And CBOOL(dict_Config(&quot;Screenshot_AutoSystemException&quot;))]" DisplayName="If no screenshot yet and auto enabled THEN Take Screenshot" sap:VirtualizedContainerService.HintSize="450,533" sap2010:WorkflowViewState.IdRef="If_50">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <Sequence DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="416,292" sap2010:WorkflowViewState.IdRef="Sequence_135">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <uix:NTakeScreenshot DisplayName="Take Screenshot" FileName="screenshot.png" FileNameMode="None" sap:VirtualizedContainerService.HintSize="354,204" sap2010:WorkflowViewState.IdRef="NTakeScreenshot_3" OutImage="[img_ExceptionScreenshot]" SaveScreenshotTo="Image" Version="V3" />
                                                        </Sequence>
                                                      </If.Then>
                                                      <If.Else>
                                                        <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_336">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </Sequence>
                                                      </If.Else>
                                                    </If>
                                                  </Sequence>
                                                  <Assign sap:VirtualizedContainerService.HintSize="496,82" sap2010:WorkflowViewState.IdRef="Assign_131">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                </Sequence>
                                              </If.Else>
                                            </If>
                                          </Sequence>
                                        </If.Else>
                                      </If>
                                    </Sequence>
                                    <Sequence DisplayName="Screenshot Auto Upload" sap:VirtualizedContainerService.HintSize="710,80" sap2010:WorkflowViewState.IdRef="Sequence_138">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If Condition="[img_ExceptionScreenshot IsNot Nothing And CBOOL(dict_Config(&quot;Screenshot_AutoUploadEnabled&quot;))]" DisplayName="If Screenshot Taken and Auto Upload Enabled THEN Upload it" sap:VirtualizedContainerService.HintSize="510,505" sap2010:WorkflowViewState.IdRef="If_51">
                                        <If.Then>
                                          <Sequence DisplayName="Upload Screenshot" sap:VirtualizedContainerService.HintSize="476,323" sap2010:WorkflowViewState.IdRef="Sequence_137">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\UploadScreenshot.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="434,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_72" UnSafe="False" WorkflowFileName="Framework\Screenshot_Save.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_Suffix">AutoUpload</InArgument>
                                                <InArgument x:TypeArguments="ui:Image" x:Key="in_Screenshot">[img_ExceptionScreenshot]</InArgument>
                                                <InArgument x:TypeArguments="x:Boolean" x:Key="in_UseNetworkFolder">[CBOOL(dict_Config("Screenshot_AutoUploadUseNetworkFolder"))]</InArgument>
                                                <InArgument x:TypeArguments="x:Boolean" x:Key="in_UseStorageBucket">[CBOOL(dict_Config("Screenshot_AutoUploadUseStorageBucket"))]</InArgument>
                                                <InArgument x:TypeArguments="ui:UiElement" x:Key="in_Element" />
                                                <InArgument x:TypeArguments="x:String" x:Key="in_FilenameOverride" />
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_Filename" />
                                                <InArgument x:TypeArguments="x:String" x:Key="in_Identifier">[dt_Report.Rows(int_TIndex)("T_Reference").ToString]</InArgument>
                                                <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Config">[dict_Config]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                            <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_120">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="ui:Image">[img_ExceptionScreenshot]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="ui:Image">[Nothing]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <Sequence DisplayName="" sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_240">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </Sequence>
                                        </If.Else>
                                      </If>
                                    </Sequence>
                                    <Sequence DisplayName="Manage Local and Network Folders" sap:VirtualizedContainerService.HintSize="710,707" sap2010:WorkflowViewState.IdRef="Sequence_388">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If Condition="[CBOOL(dict_Config(&quot;LocalFolder_ClearTransaction&quot;))]" DisplayName="If LocalFolder_ClearTransaction is true THEN Clear Local Folder" sap:VirtualizedContainerService.HintSize="563,25" sap2010:WorkflowViewState.IdRef="If_120">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Sequence DisplayName="Clear Local Folder" sap:VirtualizedContainerService.HintSize="376,201" sap2010:WorkflowViewState.IdRef="Sequence_390">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\ManageLocalFolder.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_112" UnSafe="False" WorkflowFileName="Framework\LocalFolder_Manage.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="io_Config">[dict_Config]</InOutArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <Sequence DisplayName="" sap:VirtualizedContainerService.HintSize="376,229" sap2010:WorkflowViewState.IdRef="Sequence_391">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,141" sap2010:WorkflowViewState.IdRef="LogMessage_94" Level="[UiPath.Core.Activities.LogLevel.Trace]" Message="[&quot;Local Folder not configured to clean after each transaction, skipping...&quot;]" />
                                          </Sequence>
                                        </If.Else>
                                      </If>
                                      <Sequence DisplayName="Feature - Manage Network Folder" sap:VirtualizedContainerService.HintSize="563,531" sap2010:WorkflowViewState.IdRef="Sequence_392">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:IfElseIf DisplayName="If transaction subfolder for network folder THEN manage" sap:VirtualizedContainerService.HintSize="501,420" sap2010:WorkflowViewState.IdRef="IfElseIf_7">
                                          <ui:IfElseIf.ConditionBlocks>
                                            <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                              <ui:IfElseIfBlock BlockType="If" Condition="[dict_Config(&quot;NetworkFolder_SubfolderType&quot;) = &quot;Transaction&quot;]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_8">
                                                <ui:IfElseIfBlock.Then>
                                                  <Sequence DisplayName="Manage Transaction Subfolder in Network Folder" sap:VirtualizedContainerService.HintSize="450,224" sap2010:WorkflowViewState.IdRef="Sequence_389">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\ManageNetworkFolder.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="388,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_111" UnSafe="False" WorkflowFileName="Framework\NetworkFolder_Manage.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="io_Config">[dict_Config]</InOutArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="in_Key">[dt_Report.Rows(int_TIndex)("T_Key").ToString]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="in_Action">NOTHING</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                  </Sequence>
                                                </ui:IfElseIfBlock.Then>
                                              </ui:IfElseIfBlock>
                                            </sc:BindingList>
                                          </ui:IfElseIf.ConditionBlocks>
                                        </ui:IfElseIf>
                                      </Sequence>
                                    </Sequence>
                                    <Sequence DisplayName="Remove Transaction Log Fields" sap:VirtualizedContainerService.HintSize="625,80" sap2010:WorkflowViewState.IdRef="Sequence_114">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:RemoveLogFields DisplayName="Remove Transaction Fields" sap:VirtualizedContainerService.HintSize="388,90" sap2010:WorkflowViewState.IdRef="RemoveLogFields_3">
                                        <ui:RemoveLogFields.Fields>
                                          <scg:List x:TypeArguments="InArgument(x:String)" Capacity="8">
                                            <InArgument x:TypeArguments="x:String">Transaction_Reference</InArgument>
                                            <InArgument x:TypeArguments="x:String">Transaction_Key</InArgument>
                                            <InArgument x:TypeArguments="x:String">Transaction_Counter</InArgument>
                                            <InArgument x:TypeArguments="x:String">Transaction_SourceKey</InArgument>
                                            <InArgument x:TypeArguments="x:String">Transaction_RetryNbr</InArgument>
                                          </scg:List>
                                        </ui:RemoveLogFields.Fields>
                                      </ui:RemoveLogFields>
                                    </Sequence>
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,141" sap2010:WorkflowViewState.IdRef="LogMessage_88" Level="Info" Message="[&quot;Performer Type Iteration requires no action for Finalize Transaction&quot;]" />
                                </If.Else>
                              </If>
                            </Sequence>
                          </TryCatch.Try>
                          <TryCatch.Catches>
                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="767,21" sap2010:WorkflowViewState.IdRef="Catch`1_16">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="s:Exception">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Finalize Transaction Exception" sap:VirtualizedContainerService.HintSize="496,374" sap2010:WorkflowViewState.IdRef="Sequence_67">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="434,141" sap2010:WorkflowViewState.IdRef="LogMessage_53" Level="Error" Message="[str_State &amp; &quot; State Failed: &quot; + exception.Message]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:LogMessage>
                                  <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_53">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                              </ActivityAction>
                            </Catch>
                          </TryCatch.Catches>
                        </TryCatch>
                      </State.Entry>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">416.5,827</av:Point>
                          <av:Size x:Key="ShapeSize">251,172</av:Size>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Double x:Key="StateContainerWidth">217</x:Double>
                          <x:Double x:Key="StateContainerHeight">33</x:Double>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <State.Exit>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke EndState workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_38" UnSafe="False" WorkflowFileName="Framework\State_End.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="x:String" x:Key="in_LeavingState">[str_State]</InArgument>
                            <InArgument x:TypeArguments="s:DateTime" x:Key="in_StateStart">[tsp_StateStart]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                      </State.Exit>
                      <State.Transitions>
                        <Transition DisplayName="More T Allowed" sap:VirtualizedContainerService.HintSize="1042,510" sap2010:WorkflowViewState.IdRef="Transition_22">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <av:PointCollection x:Key="ConnectorLocation">529.45,827 529.45,797 530,797 530,723</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">34</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">39</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.To>
                            <State x:Name="__ReferenceID4" sap2010:Annotation.AnnotationText="Reset apps, variables, and custom log fields back to initial state for next Transaction." DisplayName="Reset Job" sap:VirtualizedContainerService.HintSize="233,131" sap2010:WorkflowViewState.IdRef="State_7">
                              <State.Entry>
                                <TryCatch DisplayName="Try Catch Reset Job" sap:VirtualizedContainerService.HintSize="641,1178" sap2010:WorkflowViewState.IdRef="TryCatch_14">
                                  <TryCatch.Try>
                                    <Sequence DisplayName="Try Reset Job" sap:VirtualizedContainerService.HintSize="603,950" sap2010:WorkflowViewState.IdRef="Sequence_43">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke StartState" sap:VirtualizedContainerService.HintSize="541,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_39" UnSafe="False" WorkflowFileName="Framework\State_Start.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_StateName">Reset Job</InArgument>
                                          <OutArgument x:TypeArguments="s:DateTime" x:Key="out_StateStart">[tsp_StateStart]</OutArgument>
                                          <OutArgument x:TypeArguments="x:String" x:Key="out_StateName">[str_State]</OutArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                      <Sequence DisplayName="Reset Variables" sap:VirtualizedContainerService.HintSize="541,352" sap2010:WorkflowViewState.IdRef="Sequence_108">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:MultipleAssign DisplayName="Reset Vars - Objects to Nothing and Increment TIndex" sap:VirtualizedContainerService.HintSize="479,232" sap2010:WorkflowViewState.IdRef="MultipleAssign_10">
                                          <ui:MultipleAssign.AssignOperations>
                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_50">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="ui:Image">[img_ExceptionScreenshot]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="ui:Image">[Nothing]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_51">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_52">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="ui:QueueItem">[qi_Current]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="ui:QueueItem">[Nothing]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_53">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[int_TIndex]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="x:Int32">[int_TIndex + 1]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                            </scg:List>
                                          </ui:MultipleAssign.AssignOperations>
                                        </ui:MultipleAssign>
                                      </Sequence>
                                      <Sequence DisplayName="Reset Apps" sap:VirtualizedContainerService.HintSize="541,306" sap2010:WorkflowViewState.IdRef="Sequence_109">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke KillAllProcesses" sap:VirtualizedContainerService.HintSize="388,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_122" UnSafe="False" WorkflowFileName="Framework\Applications_Kill.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_AppList">[dict_Config("Application_KillList").ToString]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:InvokeWorkflowFile>
                                      </Sequence>
                                    </Sequence>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="607,22" sap2010:WorkflowViewState.IdRef="Catch`1_15">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                        <Sequence DisplayName="Reset Job Exception" sap:VirtualizedContainerService.HintSize="496,366" sap2010:WorkflowViewState.IdRef="Sequence_44">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="434,173" sap2010:WorkflowViewState.IdRef="LogMessage_42" Level="Error" Message="[str_State &amp; &quot; State Failed: &quot; + exception.Message]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:LogMessage>
                                          <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_43">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </Sequence>
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                </TryCatch>
                              </State.Entry>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">413.5,592</av:Point>
                                  <av:Size x:Key="ShapeSize">233,131</av:Size>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <x:Double x:Key="StateContainerWidth">198.9498035339633</x:Double>
                                  <x:Double x:Key="StateContainerHeight">36.78234994916488</x:Double>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <State.Exit>
                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke EndState workflow" sap:VirtualizedContainerService.HintSize="334,172" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_40" UnSafe="False" WorkflowFileName="Framework\State_End.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="x:String" x:Key="in_LeavingState">[str_State]</InArgument>
                                    <InArgument x:TypeArguments="s:DateTime" x:Key="in_StateStart">[tsp_StateStart]</InArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                              </State.Exit>
                              <State.Transitions>
                                <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="450,509" sap2010:WorkflowViewState.IdRef="Transition_17">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:PointCollection x:Key="ConnectorLocation">413.5,618.2 383.5,618.2 383.5,584.6 255.5,584.6</av:PointCollection>
                                      <x:Int32 x:Key="SrcConnectionPointIndex">13</x:Int32>
                                      <x:Int32 x:Key="DestConnectionPointIndex">52</x:Int32>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Transition.To>
                                    <x:Reference>__ReferenceID0</x:Reference>
                                  </Transition.To>
                                  <Transition.Action>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_45" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Reset Job</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Initialize Transaction</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Success</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Condition">ex_Exception Is Nothing</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                  </Transition.Action>
                                  <Transition.Condition>[ex_Exception Is Nothing]</Transition.Condition>
                                </Transition>
                                <Transition DisplayName="Exception" sap:VirtualizedContainerService.HintSize="450,509" sap2010:WorkflowViewState.IdRef="Transition_23">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:PointCollection x:Key="ConnectorLocation">646.5,657.5 676.5,657.5 676.5,625 783,625</av:PointCollection>
                                      <x:Int32 x:Key="SrcConnectionPointIndex">36</x:Int32>
                                      <x:Int32 x:Key="DestConnectionPointIndex">69</x:Int32>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Transition.To>
                                    <State x:Name="__ReferenceID1" sap2010:Annotation.AnnotationText="Write dt_Report to Log DB, capture SystemException screenshot (if applicable), logout and close all applications, send Recap Email, and set job status appropriately." DisplayName="Finalize Job" sap:VirtualizedContainerService.HintSize="162,565" sap2010:WorkflowViewState.IdRef="State_1" IsFinal="True">
                                      <State.Entry>
                                        <TryCatch DisplayName="Try Finalize Job" sap:VirtualizedContainerService.HintSize="726,2345" sap2010:WorkflowViewState.IdRef="TryCatch_4">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch.Try>
                                            <Sequence DisplayName="Try Finalize Job" sap:VirtualizedContainerService.HintSize="902,6018" sap2010:WorkflowViewState.IdRef="Sequence_40">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke StartState" sap:VirtualizedContainerService.HintSize="840,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_43" UnSafe="False" WorkflowFileName="Framework\State_Start.xaml">
                                                <ui:InvokeWorkflowFile.Arguments>
                                                  <InArgument x:TypeArguments="x:String" x:Key="in_StateName">Finalize Job</InArgument>
                                                  <OutArgument x:TypeArguments="s:DateTime" x:Key="out_StateStart">[tsp_StateStart]</OutArgument>
                                                  <OutArgument x:TypeArguments="x:String" x:Key="out_StateName">[str_State]</OutArgument>
                                                </ui:InvokeWorkflowFile.Arguments>
                                              </ui:InvokeWorkflowFile>
                                              <Sequence DisplayName="Join dt_ReportDetails to dt_Report" sap:VirtualizedContainerService.HintSize="840,1392" sap2010:WorkflowViewState.IdRef="Sequence_335">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[dt_ReportDetails IsNot Nothing AndAlso dict_Config.Keys.Contains(&quot;ReportDetails_Key&quot;) AndAlso dict_Config(&quot;ReportDetails_Key&quot;).ToString &lt;&gt; &quot;&quot; AndAlso dt_Report.Columns.Contains(dict_Config(&quot;ReportDetails_Key&quot;).ToString) AndAlso dt_ReportDetails.Columns.Contains(dict_Config(&quot;ReportDetails_Key&quot;).ToString)]" DisplayName="If dt_ReportDetails is populated AND ReportDetails_Key is set THEN join" sap:VirtualizedContainerService.HintSize="778,1272" sap2010:WorkflowViewState.IdRef="If_116">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Then" sap:VirtualizedContainerService.HintSize="744,1008" sap2010:WorkflowViewState.IdRef="Sequence_333">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:JoinDataTables DataTable1="[dt_Report]" DataTable2="[dt_ReportDetails]" DisplayName="Join Data Tables" sap:VirtualizedContainerService.HintSize="682,92" sap2010:WorkflowViewState.IdRef="JoinDataTables_1" JoinType="Full" OutputDataTable="[dt_Report]">
                                                        <ui:JoinDataTables.Arguments>
                                                          <scg:List x:TypeArguments="ui:JoinOperationArgument" Capacity="4">
                                                            <ui:JoinOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EQ">
                                                              <ui:JoinOperationArgument.Column1>
                                                                <InArgument x:TypeArguments="x:String">[dict_Config("ReportDetails_Key").ToString]</InArgument>
                                                              </ui:JoinOperationArgument.Column1>
                                                              <ui:JoinOperationArgument.Column2>
                                                                <InArgument x:TypeArguments="x:String">[dict_Config("ReportDetails_Key").ToString]</InArgument>
                                                              </ui:JoinOperationArgument.Column2>
                                                            </ui:JoinOperationArgument>
                                                          </scg:List>
                                                        </ui:JoinDataTables.Arguments>
                                                      </ui:JoinDataTables>
                                                      <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dt_Report]" DisplayName="For Each Row in Data Table - Graduate Exceptions" sap:VirtualizedContainerService.HintSize="682,828" sap2010:WorkflowViewState.IdRef="ForEachRow_4">
                                                        <ui:ForEachRow.Body>
                                                          <ActivityAction x:TypeArguments="sd:DataRow">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                            </ActivityAction.Argument>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="648,641" sap2010:WorkflowViewState.IdRef="Sequence_417">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If Condition="[(String.IsNullOrEmpty(row(&quot;D_Success&quot;).ToString) OrElse CBool(row(&quot;D_Success&quot;)) = False And row(&quot;D_ExceptionType&quot;).ToString = &quot;&quot;) AndAlso CBool(row(&quot;T_Success&quot;)) = False]" DisplayName="If (detail success is empty OR d_exception with no message) AND transaction has an exception THEN graduate" sap:VirtualizedContainerService.HintSize="586,553" sap2010:WorkflowViewState.IdRef="If_121">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence DisplayName="Graduate Exception" sap:VirtualizedContainerService.HintSize="541,289" sap2010:WorkflowViewState.IdRef="Sequence_418">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479,201" sap2010:WorkflowViewState.IdRef="MultipleAssign_12">
                                                                      <ui:MultipleAssign.AssignOperations>
                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_57">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:Object">[row("D_Success")]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:Object">[row("T_Success")]</InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_58">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:Object">[row("D_ExceptionType")]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:Object">[row("T_ExceptionType")]</InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_59">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:Object">[row("D_ExceptionMessage")]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:Object">[row("T_ExceptionMessage")]</InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                        </scg:List>
                                                                      </ui:MultipleAssign.AssignOperations>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:MultipleAssign>
                                                                  </Sequence>
                                                                </If.Then>
                                                                <If.Else>
                                                                  <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_419">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </Sequence>
                                                                </If.Else>
                                                              </If>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:ForEachRow.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:ForEachRow>
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_334">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                              <Sequence DisplayName="Load dt_Report into DB" sap:VirtualizedContainerService.HintSize="840,57" sap2010:WorkflowViewState.IdRef="Sequence_60">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[CBool(dict_Config(&quot;LogDB_Enabled&quot;)) And dt_Report.RowCount &gt; 0]" DisplayName="If LogDB is enabled and dt_Report has rows THEN insert ELSE skip" sap:VirtualizedContainerService.HintSize="550,1208" sap2010:WorkflowViewState.IdRef="If_92">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Load dt_report into DB" sap:VirtualizedContainerService.HintSize="516,795" sap2010:WorkflowViewState.IdRef="Sequence_228">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="454,173" sap2010:WorkflowViewState.IdRef="LogMessage_47" Level="Info" Message="[&quot;Attempting to load &quot; &amp; dt_Report.RowCount &amp; &quot; items into LogDB...&quot;]" />
                                                      <TryCatch DisplayName="Try Catch - Insert into DB" sap:VirtualizedContainerService.HintSize="454,534" sap2010:WorkflowViewState.IdRef="TryCatch_16">
                                                        <TryCatch.Variables>
                                                          <Variable x:TypeArguments="sd:DataTable" Name="dt_LogReport" />
                                                          <Variable x:TypeArguments="x:String" Name="str_DTOutput" />
                                                        </TryCatch.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <TryCatch.Try>
                                                          <Sequence DisplayName="Insert into DB" sap:VirtualizedContainerService.HintSize="416,283" sap2010:WorkflowViewState.IdRef="Sequence_59">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\InsertIntoDB.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="354,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_97" UnSafe="False" WorkflowFileName="Framework\LogDB_InsertDatatable.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Config">[dict_Config]</InArgument>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="in_Values">[dt_Report]</InArgument>
                                                                <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_InsertResults">[dt_LogReport]</OutArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="in_TableName">[dict_Config("Process") &amp; "_" &amp; dict_Config("Action")]</InArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                          </Sequence>
                                                        </TryCatch.Try>
                                                        <TryCatch.Catches>
                                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="420,22" sap2010:WorkflowViewState.IdRef="Catch`1_17">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ActivityAction x:TypeArguments="s:Exception">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Catch Insert into DB" sap:VirtualizedContainerService.HintSize="416,537" sap2010:WorkflowViewState.IdRef="Sequence_118">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,173" sap2010:WorkflowViewState.IdRef="LogMessage_70" Level="Error" Message="[&quot;Failed to insert dt_Report records into Log DB, will attempt to output dt_Report to Orchestrator logs.  Error Message: &quot; &amp; exception.Message]" />
                                                                <ui:OutputDataTable DataTable="[dt_Report]" DisplayName="Output Data Table" sap:VirtualizedContainerService.HintSize="354,112" sap2010:WorkflowViewState.IdRef="OutputDataTable_1" Text="[str_DTOutput]" />
                                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,164" sap2010:WorkflowViewState.IdRef="LogMessage_71" Level="Info" Message="[str_DTOutput]" />
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </Catch>
                                                        </TryCatch.Catches>
                                                      </TryCatch>
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence DisplayName="LogDB Disabled" sap:VirtualizedContainerService.HintSize="416,252" sap2010:WorkflowViewState.IdRef="Sequence_229">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,164" sap2010:WorkflowViewState.IdRef="LogMessage_92" Level="Trace" Message="[&quot;Skipping putting DT Report into LogDB, disabled in Config&quot;]" />
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                              <Sequence DisplayName="Handle Non-Transaction System Exception" sap:VirtualizedContainerService.HintSize="840,57" sap2010:WorkflowViewState.IdRef="Sequence_331">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[ex_Exception IsNot Nothing AndAlso ex_Exception.GetType.ToString.Contains(&quot;Business&quot;) = False]" DisplayName="If Non-Transaction SE has occurred THEN Capture" sap:VirtualizedContainerService.HintSize="575,1145" sap2010:WorkflowViewState.IdRef="If_114">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Take Screenshot and Set Bool" sap:VirtualizedContainerService.HintSize="514,872" sap2010:WorkflowViewState.IdRef="Sequence_329">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="452,114" sap2010:WorkflowViewState.IdRef="Assign_181">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[bln_NonTransactionSE]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="452,114" sap2010:WorkflowViewState.IdRef="Assign_182">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[dict_Config("NonTransactionSE")]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[ex_Exception.Message]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <If Condition="[img_ExceptionScreenshot Is Nothing AndAlso CBOOL(dict_Config(&quot;Screenshot_AutoSystemException&quot;))]" DisplayName="If NTSE hasn't been screenshot AND screenshot enabled THEN Take Screenshot" sap:VirtualizedContainerService.HintSize="452,556" sap2010:WorkflowViewState.IdRef="If_115">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Then" sap:VirtualizedContainerService.HintSize="416,292" sap2010:WorkflowViewState.IdRef="Sequence_327">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <uix:NTakeScreenshot DisplayName="Take Screenshot" FileNameMode="None" sap:VirtualizedContainerService.HintSize="354,204" sap2010:WorkflowViewState.IdRef="NTakeScreenshot_7" OutImage="[img_ExceptionScreenshot]" SaveScreenshotTo="Image" Version="V3" />
                                                          </Sequence>
                                                        </If.Then>
                                                        <If.Else>
                                                          <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_328">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </Sequence>
                                                        </If.Else>
                                                      </If>
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_330">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                                <If Condition="[int_MostConsecutiveSE &gt;= CInt(dict_Config(&quot;ConsecutiveSE_TerminateJob&quot;))]" DisplayName="If ConsecutiveSE_TerminateJob reached" sap:VirtualizedContainerService.HintSize="575,522" sap2010:WorkflowViewState.IdRef="If_117">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Then" sap:VirtualizedContainerService.HintSize="541,258" sap2010:WorkflowViewState.IdRef="Sequence_337">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479,170" sap2010:WorkflowViewState.IdRef="MultipleAssign_9">
                                                        <ui:MultipleAssign.AssignOperations>
                                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_44">
                                                              <ui:AssignOperation.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[bln_NonTransactionSE]</OutArgument>
                                                              </ui:AssignOperation.To>
                                                              <ui:AssignOperation.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </ui:AssignOperation.Value>
                                                            </ui:AssignOperation>
                                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_45">
                                                              <ui:AssignOperation.To>
                                                                <OutArgument x:TypeArguments="x:String">[dict_Config("NonTransactionSE")]</OutArgument>
                                                              </ui:AssignOperation.To>
                                                              <ui:AssignOperation.Value>
                                                                <InArgument x:TypeArguments="x:String">["Consecutive System Exceptions before Job Termination reached: " &amp; int_MostConsecutiveSE &amp; " / " &amp; dict_Config("ConsecutiveSE_TerminateJob")]</InArgument>
                                                              </ui:AssignOperation.Value>
                                                            </ui:AssignOperation>
                                                          </scg:List>
                                                        </ui:MultipleAssign.AssignOperations>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:MultipleAssign>
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_338">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                              <Sequence DisplayName="Screenshot Auto Upload" sap:VirtualizedContainerService.HintSize="840,57" sap2010:WorkflowViewState.IdRef="Sequence_140">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[img_ExceptionScreenshot IsNot Nothing And CBOOL(dict_Config(&quot;Screenshot_AutoUploadEnabled&quot;))]" DisplayName="If Screenshot Taken and Auto Upload Enabled THEN Upload Screenshot" sap:VirtualizedContainerService.HintSize="561,819" sap2010:WorkflowViewState.IdRef="If_52">
                                                  <If.Then>
                                                    <Sequence DisplayName="Upload Screenshot" sap:VirtualizedContainerService.HintSize="527,637" sap2010:WorkflowViewState.IdRef="Sequence_139">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="x:String" Name="str_Identifier" />
                                                      </Sequence.Variables>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:IfElseIf DisplayName="IF NonTransactionSE THEN Identifer is JobID ELSE identifier is T_Reference" sap:VirtualizedContainerService.HintSize="485,396" sap2010:WorkflowViewState.IdRef="IfElseIf_1">
                                                        <ui:IfElseIf.ConditionBlocks>
                                                          <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                            <ui:IfElseIfBlock BlockType="If" Condition="[bln_NonTransactionSE]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_9">
                                                              <ui:IfElseIfBlock.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_169">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[str_Identifier]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[dict_Config("JobID").ToString]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </ui:IfElseIfBlock.Then>
                                                            </ui:IfElseIfBlock>
                                                            <ui:IfElseIfBlock BlockType="Else" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_10">
                                                              <ui:IfElseIfBlock.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_170">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[str_Identifier]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[dt_Report.Rows(int_TIndex)("T_Key").ToString]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </ui:IfElseIfBlock.Then>
                                                            </ui:IfElseIfBlock>
                                                          </sc:BindingList>
                                                        </ui:IfElseIf.ConditionBlocks>
                                                      </ui:IfElseIf>
                                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\UploadScreenshot.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="485,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_73" UnSafe="False" WorkflowFileName="Framework\Screenshot_Save.xaml">
                                                        <ui:InvokeWorkflowFile.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_Suffix">AutoUpload</InArgument>
                                                          <InArgument x:TypeArguments="ui:Image" x:Key="in_Screenshot">[img_ExceptionScreenshot]</InArgument>
                                                          <InArgument x:TypeArguments="x:Boolean" x:Key="in_UseNetworkFolder">[CBOOL(dict_Config("Screenshot_AutoUploadUseNetworkFolder"))]</InArgument>
                                                          <InArgument x:TypeArguments="x:Boolean" x:Key="in_UseStorageBucket">[CBOOL(dict_Config("Screenshot_AutoUploadUseStorageBucket"))]</InArgument>
                                                          <InArgument x:TypeArguments="ui:UiElement" x:Key="in_Element" />
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_FilenameOverride" />
                                                          <OutArgument x:TypeArguments="x:String" x:Key="out_Filename" />
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_Identifier">[str_Identifier]</InArgument>
                                                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Config">[dict_Config]</InArgument>
                                                        </ui:InvokeWorkflowFile.Arguments>
                                                      </ui:InvokeWorkflowFile>
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence DisplayName="" sap2010:WorkflowViewState.IdRef="Sequence_234" />
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                              <Sequence DisplayName="Send Recap Email - Normal (Single) or Grouped (Multiple)" sap:VirtualizedContainerService.HintSize="840,3911" sap2010:WorkflowViewState.IdRef="Sequence_131">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="sd:DataTable" Name="dt_Temp" />
                                                  <Variable x:TypeArguments="x:Int32" Name="int_SuccessRecords" />
                                                  <Variable x:TypeArguments="x:Int32" Name="int_BERecords" />
                                                  <Variable x:TypeArguments="x:Int32" Name="int_SERecords" />
                                                  <Variable x:TypeArguments="sd:DataTable" Default="[New DataTable]" Name="dt_DuplicateCheck" />
                                                  <Variable x:TypeArguments="x:Boolean" Default="False" Name="bln_GroupMode" />
                                                  <Variable x:TypeArguments="sd:DataTable" Name="dt_CurrentGroup" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="704,114" sap2010:WorkflowViewState.IdRef="Assign_191">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:Boolean">[bln_GroupMode]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:Boolean">[dict_Config.Keys.Contains("Recap_GroupBy") AndAlso dict_Config("Recap_GroupBy") &lt;&gt; ""]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Sequence DisplayName="Get Record Counts" sap:VirtualizedContainerService.HintSize="704,57" sap2010:WorkflowViewState.IdRef="Sequence_413">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:FilterDataTable DataTable="[dt_Report]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="434,161" sap2010:WorkflowViewState.IdRef="FilterDataTable_14" OutputDataTable="[dt_Temp]" SelectColumnsMode="Keep">
                                                    <ui:FilterDataTable.Filters>
                                                      <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                        <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                          <ui:FilterOperationArgument.Column>
                                                            <InArgument x:TypeArguments="x:String">["T_Success"]</InArgument>
                                                          </ui:FilterOperationArgument.Column>
                                                          <ui:FilterOperationArgument.Operand>
                                                            <InArgument x:TypeArguments="x:Boolean">[True]</InArgument>
                                                          </ui:FilterOperationArgument.Operand>
                                                        </ui:FilterOperationArgument>
                                                      </scg:List>
                                                    </ui:FilterDataTable.Filters>
                                                    <ui:FilterDataTable.SelectColumns>
                                                      <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                        <x:Null />
                                                      </scg:List>
                                                    </ui:FilterDataTable.SelectColumns>
                                                  </ui:FilterDataTable>
                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_194">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[int_SuccessRecords]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Int32">[dt_Temp.RowCount]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <ui:FilterDataTable DataTable="[dt_Report]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="434,161" sap2010:WorkflowViewState.IdRef="FilterDataTable_12" OutputDataTable="[dt_Temp]" SelectColumnsMode="Keep">
                                                    <ui:FilterDataTable.Filters>
                                                      <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                        <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                                          <ui:FilterOperationArgument.Column>
                                                            <InArgument x:TypeArguments="x:String">["T_ExceptionType"]</InArgument>
                                                          </ui:FilterOperationArgument.Column>
                                                          <ui:FilterOperationArgument.Operand>
                                                            <InArgument x:TypeArguments="x:String">["Business"]</InArgument>
                                                          </ui:FilterOperationArgument.Operand>
                                                        </ui:FilterOperationArgument>
                                                      </scg:List>
                                                    </ui:FilterDataTable.Filters>
                                                    <ui:FilterDataTable.SelectColumns>
                                                      <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                        <x:Null />
                                                      </scg:List>
                                                    </ui:FilterDataTable.SelectColumns>
                                                  </ui:FilterDataTable>
                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_195">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[int_BERecords]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Int32">[dt_Temp.RowCount]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <ui:FilterDataTable DataTable="[dt_Report]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="434,161" sap2010:WorkflowViewState.IdRef="FilterDataTable_13" OutputDataTable="[dt_Temp]" SelectColumnsMode="Keep">
                                                    <ui:FilterDataTable.Filters>
                                                      <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                        <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="NOTEMPTY">
                                                          <ui:FilterOperationArgument.Column>
                                                            <InArgument x:TypeArguments="x:String">["T_ExceptionType"]</InArgument>
                                                          </ui:FilterOperationArgument.Column>
                                                        </ui:FilterOperationArgument>
                                                        <ui:FilterOperationArgument BooleanOperator="And" Operator="NOTCONTAINS">
                                                          <ui:FilterOperationArgument.Column>
                                                            <InArgument x:TypeArguments="x:String">["T_ExceptionType"]</InArgument>
                                                          </ui:FilterOperationArgument.Column>
                                                          <ui:FilterOperationArgument.Operand>
                                                            <InArgument x:TypeArguments="x:String">["Business"]</InArgument>
                                                          </ui:FilterOperationArgument.Operand>
                                                        </ui:FilterOperationArgument>
                                                      </scg:List>
                                                    </ui:FilterDataTable.Filters>
                                                    <ui:FilterDataTable.SelectColumns>
                                                      <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                        <x:Null />
                                                      </scg:List>
                                                    </ui:FilterDataTable.SelectColumns>
                                                  </ui:FilterDataTable>
                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_196">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[int_SERecords]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Int32">[dt_Temp.RowCount]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,141" sap2010:WorkflowViewState.IdRef="LogMessage_96" Level="Info" Message="[&quot;Record Counts: Success = &quot; &amp; int_SuccessRecords &amp; &quot;, BusinessException = &quot; &amp; int_BERecords &amp; &quot;, SystemException = &quot; &amp; int_SERecords]" />
                                                </Sequence>
                                                <ui:IfElseIf DisplayName="If group mode THEN duplicate check is one row per unique combo ELSE one blank row" sap:VirtualizedContainerService.HintSize="704,1037" sap2010:WorkflowViewState.IdRef="IfElseIf_13">
                                                  <ui:IfElseIf.ConditionBlocks>
                                                    <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                      <ui:IfElseIfBlock BlockType="If" Condition="[bln_GroupMode AndAlso dt_Report.RowCount &gt; 0]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_12">
                                                        <ui:IfElseIfBlock.Then>
                                                          <Sequence DisplayName="Grouped - Row Per Unique Combination" sap:VirtualizedContainerService.HintSize="496,362" sap2010:WorkflowViewState.IdRef="Sequence_406">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_190">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="sd:DataTable">[dt_DuplicateCheck]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="sd:DataTable">[dt_Report.Copy]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each column in dt_Report remove corresponding column in Duplicate Check if not group by column" sap:VirtualizedContainerService.HintSize="434,57" sap2010:WorkflowViewState.IdRef="ForEach`1_3" Values="[dt_Report.Columns]">
                                                              <ui:ForEach.Body>
                                                                <ActivityAction x:TypeArguments="sd:DataColumn">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="col" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="543,581" sap2010:WorkflowViewState.IdRef="Sequence_408">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:IfElseIf DisplayName="If column name is NOT a group by column THEN remove it" sap:VirtualizedContainerService.HintSize="501,493" sap2010:WorkflowViewState.IdRef="IfElseIf_14">
                                                                      <ui:IfElseIf.ConditionBlocks>
                                                                        <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                          <ui:IfElseIfBlock BlockType="If" Condition="[dict_Config(&quot;Recap_GroupBy&quot;).Split(&quot;,&quot;).Contains(col.ColumnName) = False]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_11">
                                                                            <ui:IfElseIfBlock.Then>
                                                                              <Sequence DisplayName="Remove Column - Not a Group By Column" sap:VirtualizedContainerService.HintSize="450,297" sap2010:WorkflowViewState.IdRef="Sequence_409">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <ui:RemoveDataColumn Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="[col.ColumnName]" DataTable="[dt_DuplicateCheck]" DisplayName="Remove Data Column" sap:VirtualizedContainerService.HintSize="388,186" sap2010:WorkflowViewState.IdRef="RemoveDataColumn_2" />
                                                                              </Sequence>
                                                                            </ui:IfElseIfBlock.Then>
                                                                          </ui:IfElseIfBlock>
                                                                        </sc:BindingList>
                                                                      </ui:IfElseIf.ConditionBlocks>
                                                                    </ui:IfElseIf>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:ForEach.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:ForEach>
                                                            <ui:RemoveDuplicateRows DataTable="[dt_DuplicateCheck]" DisplayName="Remove Duplicate Rows" sap:VirtualizedContainerService.HintSize="434,103" sap2010:WorkflowViewState.IdRef="RemoveDuplicateRows_1" OutputDataTable="[dt_DuplicateCheck]" />
                                                          </Sequence>
                                                        </ui:IfElseIfBlock.Then>
                                                      </ui:IfElseIfBlock>
                                                      <ui:IfElseIfBlock BlockType="Else" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_13">
                                                        <ui:IfElseIfBlock.Then>
                                                          <Sequence DisplayName="Normal - One Blank Row" sap:VirtualizedContainerService.HintSize="496,411" sap2010:WorkflowViewState.IdRef="Sequence_411">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_192">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="sd:DataTable">[dt_CurrentGroup]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="sd:DataTable">[dt_Report.Copy]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[New Object(){}]" DataTable="[dt_DuplicateCheck]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="434,209" sap2010:WorkflowViewState.IdRef="AddDataRow_6" />
                                                          </Sequence>
                                                        </ui:IfElseIfBlock.Then>
                                                      </ui:IfElseIfBlock>
                                                    </sc:BindingList>
                                                  </ui:IfElseIf.ConditionBlocks>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:IfElseIf>
                                                <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dt_DuplicateCheck]" DisplayName="For Each Row in Duplicate Check - Send a Recap" sap:VirtualizedContainerService.HintSize="704,2583" sap2010:WorkflowViewState.IdRef="ForEachRow_3">
                                                  <ui:ForEachRow.Body>
                                                    <ActivityAction x:TypeArguments="sd:DataRow">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="670,2396" sap2010:WorkflowViewState.IdRef="Sequence_410">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="bln_SkipRecap" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <Assign sap:VirtualizedContainerService.HintSize="608,114" sap2010:WorkflowViewState.IdRef="Assign_193">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:Boolean">[bln_SkipRecap]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <ui:IfElseIf DisplayName="If group mode THEN get a new current group per row (LogDB or Queue)" sap:VirtualizedContainerService.HintSize="608,920" sap2010:WorkflowViewState.IdRef="IfElseIf_15">
                                                          <ui:IfElseIf.ConditionBlocks>
                                                            <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                              <ui:IfElseIfBlock BlockType="If" Condition="[bln_GroupMode AndAlso CBool(dict_Config(&quot;LogDB_Enabled&quot;)) = True]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_14">
                                                                <ui:IfElseIfBlock.Then>
                                                                  <Sequence DisplayName="LogDB Group By" sap:VirtualizedContainerService.HintSize="416,283" sap2010:WorkflowViewState.IdRef="Sequence_412">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Framework\LogDB_GroupBy.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="354,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_119" UnSafe="False" WorkflowFileName="Framework\LogDB_GroupBy.xaml">
                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                        <OutArgument x:TypeArguments="x:Boolean" x:Key="out_HasUnfinished">[bln_SkipRecap]</OutArgument>
                                                                        <InArgument x:TypeArguments="sd:DataTable" x:Key="in_Schema">[dt_Report.Clone]</InArgument>
                                                                        <InArgument x:TypeArguments="sd:DataRow" x:Key="in_GroupBy">[row]</InArgument>
                                                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_Transactions">[dt_CurrentGroup]</OutArgument>
                                                                        <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Config">[dict_Config]</InArgument>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_ViewName" />
                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                    </ui:InvokeWorkflowFile>
                                                                  </Sequence>
                                                                </ui:IfElseIfBlock.Then>
                                                              </ui:IfElseIfBlock>
                                                              <ui:IfElseIfBlock BlockType="ElseIf" Condition="[bln_GroupMode AndAlso CBool(dict_Config(&quot;LogDB_Enabled&quot;)) = False]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_15">
                                                                <ui:IfElseIfBlock.Then>
                                                                  <Sequence DisplayName="Queue Group By" sap:VirtualizedContainerService.HintSize="416,283" sap2010:WorkflowViewState.IdRef="Sequence_415">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Framework\Queue_GroupBy.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="354,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_116" UnSafe="False" WorkflowFileName="Framework\Queue_GroupBy.xaml">
                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="in_QueueName">[dict_Config("QueueName")]</InArgument>
                                                                        <OutArgument x:TypeArguments="x:Boolean" x:Key="out_HasUnfinished">[bln_SkipRecap]</OutArgument>
                                                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_QueueItems">[dt_CurrentGroup]</OutArgument>
                                                                        <InArgument x:TypeArguments="sd:DataTable" x:Key="in_Schema">[dt_Report.Clone]</InArgument>
                                                                        <InArgument x:TypeArguments="sd:DataRow" x:Key="in_GroupBy">[row]</InArgument>
                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                    </ui:InvokeWorkflowFile>
                                                                  </Sequence>
                                                                </ui:IfElseIfBlock.Then>
                                                              </ui:IfElseIfBlock>
                                                            </sc:BindingList>
                                                          </ui:IfElseIf.ConditionBlocks>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:IfElseIf>
                                                        <ui:IfElseIf DisplayName="If Recap_ExceptionsOnly THEN Filter Successes Out" sap:VirtualizedContainerService.HintSize="608,500" sap2010:WorkflowViewState.IdRef="IfElseIf_16">
                                                          <ui:IfElseIf.ConditionBlocks>
                                                            <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                              <ui:IfElseIfBlock BlockType="If" Condition="[CBOOL(dict_Config(&quot;Recap_ExceptionsOnly&quot;))]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_16">
                                                                <ui:IfElseIfBlock.Then>
                                                                  <Sequence DisplayName="Filter Successes Out" sap:VirtualizedContainerService.HintSize="416,272" sap2010:WorkflowViewState.IdRef="Sequence_414">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:FilterDataTable DataTable="[dt_CurrentGroup]" DisplayName="Filter Data Table" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="354,184" sap2010:WorkflowViewState.IdRef="FilterDataTable_5" OutputDataTable="[dt_CurrentGroup]" SelectColumnsMode="Keep">
                                                                      <ui:FilterDataTable.Filters>
                                                                        <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                                          <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                                            <ui:FilterOperationArgument.Column>
                                                                              <InArgument x:TypeArguments="x:String">["T_Success"]</InArgument>
                                                                            </ui:FilterOperationArgument.Column>
                                                                            <ui:FilterOperationArgument.Operand>
                                                                              <InArgument x:TypeArguments="x:Boolean">[True]</InArgument>
                                                                            </ui:FilterOperationArgument.Operand>
                                                                          </ui:FilterOperationArgument>
                                                                        </scg:List>
                                                                      </ui:FilterDataTable.Filters>
                                                                      <ui:FilterDataTable.SelectColumns>
                                                                        <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                                          <x:Null />
                                                                        </scg:List>
                                                                      </ui:FilterDataTable.SelectColumns>
                                                                    </ui:FilterDataTable>
                                                                  </Sequence>
                                                                </ui:IfElseIfBlock.Then>
                                                              </ui:IfElseIfBlock>
                                                            </sc:BindingList>
                                                          </ui:IfElseIf.ConditionBlocks>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:IfElseIf>
                                                        <Sequence DisplayName="Send Recap" sap:VirtualizedContainerService.HintSize="608,774" sap2010:WorkflowViewState.IdRef="Sequence_159">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If Condition="[CBool(dict_Config(&quot;Recap_Enabled&quot;)) And (dt_CurrentGroup.RowCount &gt; 0 Or bln_NonTransactionSE) And bln_SkipRecap = False]" DisplayName="If recap enabled AND records to send THEN attempt to send ELSE do not send" sap:VirtualizedContainerService.HintSize="546,663" sap2010:WorkflowViewState.IdRef="If_54">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Then>
                                                              <Sequence DisplayName="Attempt to Send Recap" sap:VirtualizedContainerService.HintSize="512,250" sap2010:WorkflowViewState.IdRef="Sequence_143">
                                                                <Sequence.Variables>
                                                                  <Variable x:TypeArguments="x:String" Name="str_CC" />
                                                                </Sequence.Variables>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <Sequence DisplayName="Get Queue Stats and Details" sap:VirtualizedContainerService.HintSize="450,57" sap2010:WorkflowViewState.IdRef="Sequence_400">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:IfElseIf DisplayName="If SendQueueStats enabled THEN Get Queue Stats" sap:VirtualizedContainerService.HintSize="660,607" sap2010:WorkflowViewState.IdRef="IfElseIf_10">
                                                                    <ui:IfElseIf.ConditionBlocks>
                                                                      <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                        <ui:IfElseIfBlock BlockType="If" Condition="[CBool(dict_Config(&quot;Recap_SendQueueStats&quot;))]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_17">
                                                                          <ui:IfElseIfBlock.Then>
                                                                            <Sequence DisplayName="Get Queue Stats" sap:VirtualizedContainerService.HintSize="541,411" sap2010:WorkflowViewState.IdRef="Sequence_401">
                                                                              <Sequence.Variables>
                                                                                <Variable x:TypeArguments="x:Int32" Name="int_QueueInProgress" />
                                                                                <Variable x:TypeArguments="x:Int32" Name="int_QueueNew" />
                                                                              </Sequence.Variables>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Framework\Queue_GetStats.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="479,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_117" UnSafe="False" WorkflowFileName="Framework\Queue_GetStats.xaml">
                                                                                <ui:InvokeWorkflowFile.Arguments>
                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_QueueName">[dict_Config("QueueName")]</InArgument>
                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_QueueFolderPath" />
                                                                                  <OutArgument x:TypeArguments="x:Int32" x:Key="out_InProgress">[int_QueueInProgress]</OutArgument>
                                                                                  <OutArgument x:TypeArguments="x:Int32" x:Key="out_New">[int_QueueNew]</OutArgument>
                                                                                </ui:InvokeWorkflowFile.Arguments>
                                                                              </ui:InvokeWorkflowFile>
                                                                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479,147" sap2010:WorkflowViewState.IdRef="MultipleAssign_11">
                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_54">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[dict_Config("QueueStats_Chunk")]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[dict_Config("QueueStats_Chunk").Replace("{{QueueStats_InProgress}}",int_QueueInProgress.ToString)]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_55">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[dict_Config("QueueStats_Chunk")]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[dict_Config("QueueStats_Chunk").Replace("{{QueueStats_New}}",int_QueueNew.ToString)]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                  </scg:List>
                                                                                </ui:MultipleAssign.AssignOperations>
                                                                              </ui:MultipleAssign>
                                                                            </Sequence>
                                                                          </ui:IfElseIfBlock.Then>
                                                                        </ui:IfElseIfBlock>
                                                                      </sc:BindingList>
                                                                    </ui:IfElseIf.ConditionBlocks>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:IfElseIf>
                                                                  <ui:IfElseIf DisplayName="If SendQueueDetails enabled THEN Get Queue Details" sap:VirtualizedContainerService.HintSize="660,1186" sap2010:WorkflowViewState.IdRef="IfElseIf_11">
                                                                    <ui:IfElseIf.ConditionBlocks>
                                                                      <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                        <ui:IfElseIfBlock BlockType="If" Condition="[CBool(dict_Config(&quot;Recap_SendQueueDetails&quot;))]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_19">
                                                                          <ui:IfElseIfBlock.Then>
                                                                            <Sequence DisplayName="Get Queue Details" sap:VirtualizedContainerService.HintSize="609,990" sap2010:WorkflowViewState.IdRef="Sequence_402">
                                                                              <Sequence.Variables>
                                                                                <Variable x:TypeArguments="sd:DataTable" Name="dt_QueueDetails" />
                                                                              </Sequence.Variables>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Framework\Queue_GetDetails.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="547,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_118" UnSafe="False" WorkflowFileName="Framework\Queue_GetDetails.xaml">
                                                                                <ui:InvokeWorkflowFile.Arguments>
                                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_QueueName">[dict_Config("QueueName")]</InArgument>
                                                                                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_QueueItems">[dt_QueueDetails]</OutArgument>
                                                                                </ui:InvokeWorkflowFile.Arguments>
                                                                              </ui:InvokeWorkflowFile>
                                                                              <ui:IfElseIf DisplayName="If QueueDetails retrieved THEN write to local folder" sap:VirtualizedContainerService.HintSize="547,726" sap2010:WorkflowViewState.IdRef="IfElseIf_12">
                                                                                <ui:IfElseIf.ConditionBlocks>
                                                                                  <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                    <ui:IfElseIfBlock BlockType="If" Condition="[dt_QueueDetails IsNot Nothing]" sap2010:WorkflowViewState.IdRef="IfElseIfBlock_18">
                                                                                      <ui:IfElseIfBlock.Then>
                                                                                        <Sequence DisplayName="Write Queue Details to Local Folder" sap:VirtualizedContainerService.HintSize="496,530" sap2010:WorkflowViewState.IdRef="Sequence_403">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_188">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[dict_Config("Recap_QueueDetailsPath")]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[Path.Combine(dict_Config("LocalFolder"), "QueueDetails.xlsx")]</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                          <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dt_QueueDetails]" DisplayName="Write Range Workbook" sap:VirtualizedContainerService.HintSize="434,116" sap2010:WorkflowViewState.IdRef="WriteRange_1" SheetName="QueueDetails" WorkbookPath="[dict_Config(&quot;Recap_QueueDetailsPath&quot;)]" />
                                                                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,141" sap2010:WorkflowViewState.IdRef="LogMessage_95" Level="[UiPath.Core.Activities.LogLevel.Info]" Message="[&quot;Queue Details file (&quot; &amp; dt_QueueDetails.RowCount &amp; &quot; records) written to path: &quot; &amp; dict_Config(&quot;Recap_QueueDetailsPath&quot;)]" />
                                                                                        </Sequence>
                                                                                      </ui:IfElseIfBlock.Then>
                                                                                    </ui:IfElseIfBlock>
                                                                                  </sc:BindingList>
                                                                                </ui:IfElseIf.ConditionBlocks>
                                                                              </ui:IfElseIf>
                                                                            </Sequence>
                                                                          </ui:IfElseIfBlock.Then>
                                                                        </ui:IfElseIfBlock>
                                                                      </sc:BindingList>
                                                                    </ui:IfElseIf.ConditionBlocks>
                                                                  </ui:IfElseIf>
                                                                </Sequence>
                                                                <If Condition="[int_SERecords &gt; 0 Or bln_NonTransactionSE]" DisplayName="If SystemExceptions THEN CC Support ELSE do not CC Support" sap:VirtualizedContainerService.HintSize="450,57" sap2010:WorkflowViewState.IdRef="If_57">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If.Then>
                                                                    <Sequence DisplayName="CC Support" sap:VirtualizedContainerService.HintSize="476,170" sap2010:WorkflowViewState.IdRef="Sequence_151">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_100">
                                                                        <Assign.To>
                                                                          <OutArgument x:TypeArguments="x:String">[str_CC]</OutArgument>
                                                                        </Assign.To>
                                                                        <Assign.Value>
                                                                          <InArgument x:TypeArguments="x:String">[dict_Config("Recap_SupportDL").ToString]</InArgument>
                                                                        </Assign.Value>
                                                                      </Assign>
                                                                    </Sequence>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <Sequence DisplayName="" sap2010:WorkflowViewState.IdRef="Sequence_235" />
                                                                  </If.Else>
                                                                </If>
                                                                <If Condition="[String.IsNullOrEmpty(dict_Config(&quot;Recap_BusinessDL&quot;).ToString) And String.IsNullOrEmpty(str_CC)]" DisplayName="If no recipients THEN Skip Recap ELSE Send it" sap:VirtualizedContainerService.HintSize="450,48" sap2010:WorkflowViewState.IdRef="If_56">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If.Then>
                                                                    <Sequence DisplayName="Skip Recap" sap:VirtualizedContainerService.HintSize="376,229" sap2010:WorkflowViewState.IdRef="Sequence_149">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,141" sap2010:WorkflowViewState.IdRef="LogMessage_73" Level="Warn" Message="[&quot;Skipping recap email because no recipients are configured for the current situation...&quot;]" />
                                                                    </Sequence>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <Sequence DisplayName="Send Recap" sap:VirtualizedContainerService.HintSize="376,201" sap2010:WorkflowViewState.IdRef="Sequence_150">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="SendTemplateEmail.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_74" UnSafe="False" WorkflowFileName="Framework\Email_SendRecap.xaml">
                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                          <InArgument x:TypeArguments="x:Boolean" x:Key="in_UseAttachments">[CBool(dict_Config("Recap_AttachLocalFolder"))]</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="in_Template">Recap</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="in_CCDL">[str_CC]</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="in_ToDL">[dict_Config("Recap_BusinessDL")]</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="in_Action">[dict_Config("Action")]</InArgument>
                                                                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Config">[dict_Config]</InArgument>
                                                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="in_Report">[dt_CurrentGroup]</InArgument>
                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                      </ui:InvokeWorkflowFile>
                                                                    </Sequence>
                                                                  </If.Else>
                                                                </If>
                                                              </Sequence>
                                                            </If.Then>
                                                            <If.Else>
                                                              <Sequence DisplayName="No Records to Send" sap:VirtualizedContainerService.HintSize="416,252" sap2010:WorkflowViewState.IdRef="Sequence_144">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,164" sap2010:WorkflowViewState.IdRef="LogMessage_75" Level="Info" Message="[&quot;Skipping recap because there is no relevant information to send or the Recap is disabled.&quot;]" />
                                                              </Sequence>
                                                            </If.Else>
                                                          </If>
                                                        </Sequence>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:ForEachRow.Body>
                                                </ui:ForEachRow>
                                              </Sequence>
                                              <Sequence DisplayName="Manage Local and Network Folder" sap:VirtualizedContainerService.HintSize="840,57" sap2010:WorkflowViewState.IdRef="Sequence_292">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\ManageLocalFolder.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="472,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_100" UnSafe="False" WorkflowFileName="Framework\LocalFolder_Manage.xaml">
                                                  <ui:InvokeWorkflowFile.Arguments>
                                                    <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="io_Config">[dict_Config]</InOutArgument>
                                                  </ui:InvokeWorkflowFile.Arguments>
                                                </ui:InvokeWorkflowFile>
                                                <Sequence DisplayName="Feature - Manage Network Folder" sap:VirtualizedContainerService.HintSize="472,536" sap2010:WorkflowViewState.IdRef="Sequence_393">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If sap2010:Annotation.AnnotationText="SETUP REQUIRED - Actions are defaulted to &quot;NOTHING&quot;, actions should be based on your process" Condition="[dict_Config(&quot;NetworkFolder&quot;).ToString &lt;&gt; &quot;&quot;]" DisplayName="If network folder provided THEN manage" sap:VirtualizedContainerService.HintSize="410,425" sap2010:WorkflowViewState.IdRef="If_106">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <Sequence sap:VirtualizedContainerService.HintSize="376,201" sap2010:WorkflowViewState.IdRef="Sequence_304">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\ManageNetworkFolder.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_104" UnSafe="False" WorkflowFileName="Framework\NetworkFolder_Manage.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="io_Config">[dict_Config]</InOutArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="in_Key">
                                                              <Literal x:TypeArguments="x:String" Value="" />
                                                            </InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="in_Action">NOTHING</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                      </Sequence>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Sequence sap:VirtualizedContainerService.HintSize="300,80" sap2010:WorkflowViewState.IdRef="Sequence_305">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                </Sequence>
                                              </Sequence>
                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke CloseAllApplications workflow" sap:VirtualizedContainerService.HintSize="840,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_21" UnSafe="False" WorkflowFileName="Framework\Applications_Close.xaml">
                                                <ui:InvokeWorkflowFile.Arguments>
                                                  <InArgument x:TypeArguments="x:String" x:Key="in_KillApps">[dict_Config("Application_KillList").ToString]</InArgument>
                                                </ui:InvokeWorkflowFile.Arguments>
                                              </ui:InvokeWorkflowFile>
                                            </Sequence>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="692,22" sap2010:WorkflowViewState.IdRef="Catch`1_5">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="Exception" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="Catch Finalize Job" sap:VirtualizedContainerService.HintSize="530,1325" sap2010:WorkflowViewState.IdRef="Sequence_26">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If Condition="[ex_Exception Is Nothing]" DisplayName="If ex_Exception Is Not Set THEN Set ELSE Log Old and Set" sap:VirtualizedContainerService.HintSize="468,214" sap2010:WorkflowViewState.IdRef="If_15">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_47">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="s:Exception">[Exception]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Sequence DisplayName="Log Old and Set" sap:VirtualizedContainerService.HintSize="476,351" sap2010:WorkflowViewState.IdRef="Sequence_156">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,141" sap2010:WorkflowViewState.IdRef="LogMessage_76" Level="Error" Message="[&quot;Finalize Job failed while trying to handle Exception: &quot; &amp; ex_Exception.Message]" />
                                                        <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_104">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="s:Exception">[Exception]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="468,173" sap2010:WorkflowViewState.IdRef="LogMessage_77" Level="Fatal" Message="[&quot;Finalize State failed.  Exception: &quot; &amp; ex_Exception.Message]" />
                                                  <ui:RaiseAlert DisplayName="Raise Alert" sap:VirtualizedContainerService.HintSize="468,223" sap2010:WorkflowViewState.IdRef="RaiseAlert_2" Notification="[&quot;Finalize Job state failed. This could mean some or all of the queue items impacted by this job may have not been sent to Log DB and/or had a Recap sent. Review Job and Transaction logs for details.&quot;]" Severity="Warning">
                                                    <ui:RaiseAlert.TimeoutMS>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:RaiseAlert.TimeoutMS>
                                                  </ui:RaiseAlert>
                                                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke KillAllProcesses workflow" sap:VirtualizedContainerService.HintSize="468,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_22" UnSafe="False" WorkflowFileName="Framework\Applications_Kill.xaml">
                                                    <ui:InvokeWorkflowFile.Arguments>
                                                      <InArgument x:TypeArguments="x:String" x:Key="in_AppList">[dict_Config("Application_KillList").ToString]</InArgument>
                                                    </ui:InvokeWorkflowFile.Arguments>
                                                  </ui:InvokeWorkflowFile>
                                                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\EventLog_Recent.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="468,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_95" UnSafe="False" WorkflowFileName="Framework\EventLog_GetRecent.xaml">
                                                    <ui:InvokeWorkflowFile.Arguments>
                                                      <InArgument x:TypeArguments="x:String" x:Key="in_EventLog">Application</InArgument>
                                                      <InArgument x:TypeArguments="x:Int32" x:Key="in_PastMinutes">5</InArgument>
                                                    </ui:InvokeWorkflowFile.Arguments>
                                                  </ui:InvokeWorkflowFile>
                                                  <Assign sap:VirtualizedContainerService.HintSize="468,114" sap2010:WorkflowViewState.IdRef="Assign_171">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Boolean">[bln_NonTransactionSE]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <Assign sap:VirtualizedContainerService.HintSize="468,104" sap2010:WorkflowViewState.IdRef="Assign_172">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[dict_Config("NonTransactionSE")]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">[Exception.Message]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                </Sequence>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                          <TryCatch.Finally>
                                            <Sequence DisplayName="Finalize Job Finally" sap:VirtualizedContainerService.HintSize="688,2117" sap2010:WorkflowViewState.IdRef="Sequence_48">
                                              <Sequence.Variables>
                                                <Variable x:TypeArguments="sd:DataTable" Name="dt_SystemExceptionReport" />
                                                <Variable x:TypeArguments="x:String" Name="str_CombinedSystemExceptions" />
                                              </Sequence.Variables>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:FilterDataTable DataTable="[dt_Report]" DisplayName="Filter Data Table - dt_SystemExceptionReport" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="626,193" sap2010:WorkflowViewState.IdRef="FilterDataTable_10" OutputDataTable="[dt_SystemExceptionReport]" SelectColumnsMode="Keep">
                                                <ui:FilterDataTable.Filters>
                                                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                    <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="NOTEMPTY">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["D_ExceptionType"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                    </ui:FilterOperationArgument>
                                                    <ui:FilterOperationArgument BooleanOperator="And" Operator="NOTCONTAINS">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["D_ExceptionType"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                      <ui:FilterOperationArgument.Operand>
                                                        <InArgument x:TypeArguments="x:String">["Business"]</InArgument>
                                                      </ui:FilterOperationArgument.Operand>
                                                    </ui:FilterOperationArgument>
                                                  </scg:List>
                                                </ui:FilterDataTable.Filters>
                                                <ui:FilterDataTable.SelectColumns>
                                                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                    <x:Null />
                                                  </scg:List>
                                                </ui:FilterDataTable.SelectColumns>
                                              </ui:FilterDataTable>
                                              <If Condition="[bln_NonTransactionSE Or dt_SystemExceptionReport.RowCount &gt; 0]" DisplayName="If NonTransactionSE OR SE Count &gt; 0 THEN Terminate Job SE" sap:VirtualizedContainerService.HintSize="626,1641" sap2010:WorkflowViewState.IdRef="If_59">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Sequence DisplayName="Terminate Job - System Exception" sap:VirtualizedContainerService.HintSize="592,1368" sap2010:WorkflowViewState.IdRef="Sequence_157">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[bln_NonTransactionSE]" DisplayName="If NonTransactionSE THEN Use it" sap:VirtualizedContainerService.HintSize="530,466" sap2010:WorkflowViewState.IdRef="If_63">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <Sequence DisplayName="NonQISE Base Exception" sap:VirtualizedContainerService.HintSize="496,193" sap2010:WorkflowViewState.IdRef="Sequence_170">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_107">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[str_CombinedSystemExceptions]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[dict_Config("NonTransactionSE").ToString]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                      </If.Then>
                                                      <If.Else>
                                                        <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_243">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </Sequence>
                                                      </If.Else>
                                                    </If>
                                                    <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dt_SystemExceptionReport]" DisplayName="For Each Row in Data Table - Build Combined SE" sap:VirtualizedContainerService.HintSize="530,389" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
                                                      <ui:ForEachRow.Body>
                                                        <ActivityAction x:TypeArguments="sd:DataRow">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="SE" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Capture Combined System Exception Messages" sap:VirtualizedContainerService.HintSize="496,193" sap2010:WorkflowViewState.IdRef="Sequence_120">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_83">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[str_CombinedSystemExceptions]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[(str_CombinedSystemExceptions &amp; "; Key: " &amp; SE("T_Key").ToString &amp; ", ExceptionMessage: " &amp; SE("D_ExceptionMessage").ToString).TrimStart(";"c)]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:ForEachRow.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ForEachRow>
                                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="530,173" sap2010:WorkflowViewState.IdRef="LogMessage_87" Level="Error" Message="[str_CombinedSystemExceptions]" />
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke EndState workflow" sap:VirtualizedContainerService.HintSize="530,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_82" UnSafe="False" WorkflowFileName="Framework\State_End.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InArgument x:TypeArguments="x:String" x:Key="in_LeavingState">[str_State]</InArgument>
                                                        <InArgument x:TypeArguments="s:DateTime" x:Key="in_StateStart">[tsp_StateStart]</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                    <TerminateWorkflow DisplayName="Terminate Main Workflow" Exception="[New SystemException(str_CombinedSystemExceptions)]" sap:VirtualizedContainerService.HintSize="530,48" sap2010:WorkflowViewState.IdRef="TerminateWorkflow_7">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </TerminateWorkflow>
                                                  </Sequence>
                                                </If.Then>
                                                <If.Else>
                                                  <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_244">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </Sequence>
                                                </If.Else>
                                              </If>
                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke EndState workflow" sap:VirtualizedContainerService.HintSize="626,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_58" UnSafe="False" WorkflowFileName="Framework\State_End.xaml">
                                                <ui:InvokeWorkflowFile.Arguments>
                                                  <InArgument x:TypeArguments="x:String" x:Key="in_LeavingState">[str_State]</InArgument>
                                                  <InArgument x:TypeArguments="s:DateTime" x:Key="in_StateStart">[tsp_StateStart]</InArgument>
                                                </ui:InvokeWorkflowFile.Arguments>
                                              </ui:InvokeWorkflowFile>
                                            </Sequence>
                                          </TryCatch.Finally>
                                        </TryCatch>
                                      </State.Entry>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">783,116.5</av:Point>
                                          <av:Size x:Key="ShapeSize">162,565</av:Size>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Double x:Key="StateContainerWidth">128</x:Double>
                                          <x:Double x:Key="StateContainerHeight">366.00000000000006</x:Double>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <State.Variables>
                                        <Variable x:TypeArguments="x:Boolean" Name="bln_NonTransactionSE" />
                                      </State.Variables>
                                    </State>
                                  </Transition.To>
                                  <Transition.Action>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_46" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Reset Job</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Finalize Job</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Exception</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Condition">ex_Exception IsNot Nothing</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                  </Transition.Action>
                                  <Transition.Condition>[ex_Exception IsNot Nothing]</Transition.Condition>
                                </Transition>
                              </State.Transitions>
                            </State>
                          </Transition.To>
                          <Transition.Action>
                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_47" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Finalize Transaction</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Reset Job</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">More T Allowed</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="in_Condition">["int_TIndex &lt; CInt(dict_Config(""Transaction_MaxCount""))-1 And int_ConsecutiveSE &lt; CINT(dict_Config(""ConsecutiveSE_TerminateJob"")) And bln_LastTransaction = False"]</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                          </Transition.Action>
                          <Transition.Condition>[int_TIndex &lt; CInt(dict_Config("Transaction_MaxCount"))-1 And int_ConsecutiveSE &lt; CINT(dict_Config("ConsecutiveSE_TerminateJob")) And bln_LastTransaction = False]</Transition.Condition>
                        </Transition>
                        <Transition DisplayName="Last Transaction" sap:VirtualizedContainerService.HintSize="615,1071" sap2010:WorkflowViewState.IdRef="Transition_21">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <av:PointCollection x:Key="ConnectorLocation">667.5,938.8 807.3,938.8 807.3,681.5</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">48</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">11</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.To>
                            <x:Reference>__ReferenceID1</x:Reference>
                          </Transition.To>
                          <Transition.Action>
                            <Sequence DisplayName="Action - Last Transaction" sap:VirtualizedContainerService.HintSize="512,693" sap2010:WorkflowViewState.IdRef="Sequence_173">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If Condition="[bln_LastTransaction]" DisplayName="If LastTransaction THEN Log" sap:VirtualizedContainerService.HintSize="450,525" sap2010:WorkflowViewState.IdRef="If_73">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Log Long Running" sap:VirtualizedContainerService.HintSize="416,252" sap2010:WorkflowViewState.IdRef="Sequence_185">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,164" sap2010:WorkflowViewState.IdRef="LogMessage_84" Level="Info" Message="[&quot;Last Transaction due to Long Running Item.&quot;]" />
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="416,103" sap2010:WorkflowViewState.IdRef="Sequence_326">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </Sequence>
                                </If.Else>
                              </If>
                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="450,80" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_50" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Finalize Transaction</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Finalize Job</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Last Transaction</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Condition">["int_TIndex &gt;= CInt(dict_Config(""Transaction_MaxCount""))-1 Or bln_LastTransaction"]</InArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                            </Sequence>
                          </Transition.Action>
                          <Transition.Condition>[int_TIndex &gt;= CInt(dict_Config("Transaction_MaxCount"))-1 Or bln_LastTransaction]</Transition.Condition>
                        </Transition>
                        <Transition DisplayName="Met Consecutive SE Terminate Job" sap:VirtualizedContainerService.HintSize="549,1057" sap2010:WorkflowViewState.IdRef="Transition_20">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <av:PointCollection x:Key="ConnectorLocation">667.5,956 864,956 864,681.5</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">56</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">39</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.To>
                            <x:Reference>__ReferenceID1</x:Reference>
                          </Transition.To>
                          <Transition.Action>
                            <Sequence DisplayName="Met Consecutive SE Terminate Job" sap:VirtualizedContainerService.HintSize="416,679" sap2010:WorkflowViewState.IdRef="Sequence_132">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,173" sap2010:WorkflowViewState.IdRef="LogMessage_80" Level="Warn" Message="[&quot;Max Consecutive System Exceptions before Terminating Job for process &quot; &amp; dict_Config(&quot;Process&quot;).ToString &amp; &quot; met: &quot; &amp; int_ConsecutiveSE]" />
                              <ui:RaiseAlert DisplayName="Raise Alert" sap:VirtualizedContainerService.HintSize="354,223" sap2010:WorkflowViewState.IdRef="RaiseAlert_4" Notification="[&quot;Max Consecutive System Exceptions before Terminating Job for process &quot; &amp; dict_Config(&quot;Process&quot;).ToString &amp; &quot; met: &quot; &amp; int_ConsecutiveSE]" Severity="Warning">
                                <ui:RaiseAlert.TimeoutMS>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:RaiseAlert.TimeoutMS>
                              </ui:RaiseAlert>
                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="354,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_49" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Finalize Transaction</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Finalize Job</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Met Consecutive SE Terminate Job</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Condition">["int_ConsecutiveSE &gt;= CINT(dict_Config(""ConsecutiveSE_TerminateJob""))"]</InArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                            </Sequence>
                          </Transition.Action>
                          <Transition.Condition>[int_ConsecutiveSE &gt;= CINT(dict_Config("ConsecutiveSE_TerminateJob"))]</Transition.Condition>
                        </Transition>
                      </State.Transitions>
                    </State>
                  </Transition.To>
                  <Transition.Action>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_48" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Execute Process</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Finalize Transaction</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Always</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Condition">True</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </Transition.Action>
                  <Transition.Condition>True</Transition.Condition>
                </Transition>
              </State.Transitions>
              <State.Variables>
                <Variable x:TypeArguments="x:Boolean" Name="bln_LongRunning" />
              </State.Variables>
            </State>
          </Transition.To>
          <Transition.Action>
            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_32" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Initialize Transaction</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Execute Process</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Success</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_Condition">bln_MoreTransactions And ex_Exception Is Nothing And bln_ShouldStop = False</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
            </ui:InvokeWorkflowFile>
          </Transition.Action>
          <Transition.Condition>[bln_MoreTransactions And ex_Exception Is Nothing And bln_ShouldStop = False]</Transition.Condition>
        </Transition>
        <Transition DisplayName="Exception" sap:VirtualizedContainerService.HintSize="450,509" sap2010:WorkflowViewState.IdRef="Transition_11">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:PointCollection x:Key="ConnectorLocation">255.5,544 285.5,544 285.5,540.25 783,540.25</av:PointCollection>
              <x:Int32 x:Key="SrcConnectionPointIndex">36</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">57</x:Int32>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <x:Reference>__ReferenceID1</x:Reference>
          </Transition.To>
          <Transition.Action>
            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_34" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Initialize Transaction</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Finalize Job</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Exception</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_Condition">ex_Exception IsNot Nothing</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
            </ui:InvokeWorkflowFile>
          </Transition.Action>
          <Transition.Condition>[ex_Exception IsNot Nothing]</Transition.Condition>
        </Transition>
        <Transition DisplayName="No Transaction" sap:VirtualizedContainerService.HintSize="509,509" sap2010:WorkflowViewState.IdRef="Transition_18">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:PointCollection x:Key="ConnectorLocation">255.5,513.55 285.5,513.55 285.5,512 783,512</av:PointCollection>
              <x:Int32 x:Key="SrcConnectionPointIndex">24</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">53</x:Int32>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <x:Reference>__ReferenceID1</x:Reference>
          </Transition.To>
          <Transition.Action>
            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_33" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Initialize Transaction</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Finalize Job</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">No Transaction</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_Condition">bln_ShouldStop Or (bln_MoreTransactions And ex_Exception Is Nothing)</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
            </ui:InvokeWorkflowFile>
          </Transition.Action>
          <Transition.Condition>[bln_ShouldStop Or (NOT bln_MoreTransactions And ex_Exception Is Nothing)]</Transition.Condition>
        </Transition>
      </State.Transitions>
    </State>
    <x:Reference>__ReferenceID2</x:Reference>
    <x:Reference>__ReferenceID1</x:Reference>
    <State x:Name="__ReferenceID6" sap2010:Annotation.AnnotationText="Initializes all variables, custom log fields, and applications that are not Transaction specific." DisplayName="Initialize Job" sap:VirtualizedContainerService.HintSize="749,3572" sap2010:WorkflowViewState.IdRef="State_2">
      <State.Entry>
        <TryCatch DisplayName="Try Catch Initialize Job" sap:VirtualizedContainerService.HintSize="703,3064" sap2010:WorkflowViewState.IdRef="TryCatch_2">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <TryCatch.Try>
            <Sequence DisplayName="Try Initialize Job" sap:VirtualizedContainerService.HintSize="665,2836" sap2010:WorkflowViewState.IdRef="Sequence_4">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke StartState workflow" sap:VirtualizedContainerService.HintSize="603,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_41" UnSafe="False" WorkflowFileName="Framework\State_Start.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="x:String" x:Key="in_StateName">Initialize Job</InArgument>
                  <OutArgument x:TypeArguments="s:DateTime" x:Key="out_StateStart">[tsp_StateStart]</OutArgument>
                  <OutArgument x:TypeArguments="x:String" x:Key="out_StateName">[str_State]</OutArgument>
                </ui:InvokeWorkflowFile.Arguments>
              </ui:InvokeWorkflowFile>
              <Sequence DisplayName="Initialize State Map Vars" sap:VirtualizedContainerService.HintSize="603,339" sap2010:WorkflowViewState.IdRef="Sequence_160">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_108">
                  <Assign.To>
                    <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                  </Assign.Value>
                </Assign>
                <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_110">
                  <Assign.To>
                    <OutArgument x:TypeArguments="ui:Image">[img_ExceptionScreenshot]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="ui:Image">[Nothing]</InArgument>
                  </Assign.Value>
                </Assign>
              </Sequence>
              <Sequence DisplayName="Initialize Job Vars" sap:VirtualizedContainerService.HintSize="603,1981" sap2010:WorkflowViewState.IdRef="Sequence_63">
                <Sequence.Variables>
                  <Variable x:TypeArguments="x:String" Name="str_Action" />
                  <Variable x:TypeArguments="x:String" Name="str_PerformerType" />
                  <Variable x:TypeArguments="x:String" Name="str_FrameworkOrchFolder" />
                  <Variable x:TypeArguments="x:String" Name="str_ConfigLocationType" />
                  <Variable x:TypeArguments="x:String" Name="str_ConfigAssetOverride" />
                  <Variable x:TypeArguments="x:String" Name="str_ConfigPathOverride" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign sap2010:Annotation.AnnotationText="Setup Required&#xA;&#xA;Action: Performer, Dispatcher, Cleanup, or Custom&#xA;PerformerType: QI, NonQI, Iteration, PreLoad&#xA;FrameworkOrchFolder: blank string for context of running job or Studio, or Orch folder path using \ as directory separator&#xA;ConfigAssetOverride: if provided, states the name of the asset that has the paths (comma delimited) to the config folders&#xA;ConfigPathOverride: if provided, states the paths (comma delimited) to the config folders&#xA;ConfigLocationType: Folder or SharePoint (if SharePoint then more arguments need to be provided to InitAllSettings)" DisplayName="Multiple Assign - Non-Config Values" sap:VirtualizedContainerService.HintSize="541,495" sap2010:WorkflowViewState.IdRef="MultipleAssign_8">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_42">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[str_Action]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">Performer</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_43">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[str_PerformerType]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">QI</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_46">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[str_FrameworkOrchFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">
                            <Literal x:TypeArguments="x:String" Value="" />
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_48">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[str_ConfigAssetOverride]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">DriverQualificationsTraining_ConfigPaths</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_49">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[str_ConfigPathOverride]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">
                            <Literal x:TypeArguments="x:String" Value="" />
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_47">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[str_ConfigLocationType]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">Folder</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:MultipleAssign>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke InitAllSettings" sap:VirtualizedContainerService.HintSize="541,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_26" UnSafe="False" WorkflowFileName="Framework\Settings_Initialize.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="in_ConfigPathAsset">[str_ConfigAssetOverride]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="in_ConfigPathOverride">[str_ConfigPathOverride]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="in_Action">[str_Action]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="in_PerformerType">[str_PerformerType]</InArgument>
                    <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="out_Config">[dict_Config]</OutArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="in_FrameworkOrchFolder">[str_FrameworkOrchFolder]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="in_ConfigLocationType">[str_ConfigLocationType]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="in_CredentialAsset" />
                    <InArgument x:TypeArguments="x:String" x:Key="in_URLAsset" />
                    <InArgument x:TypeArguments="x:String" x:Key="in_TenantAsset" />
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Utilities\ManageLocalFolder.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="541,204" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_84" UnSafe="False" WorkflowFileName="Framework\LocalFolder_Manage.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="io_Config">[dict_Config]</InOutArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <Sequence DisplayName="Initialize dt_Report" sap:VirtualizedContainerService.HintSize="541,763" sap2010:WorkflowViewState.IdRef="Sequence_192">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="sd:DataTable" Name="dt_TechFields" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:BuildDataTable sap2010:Annotation.AnnotationText="Process specific variables" DataTable="[dt_Report]" DisplayName="Custom - Build dt_Report" sap:VirtualizedContainerService.HintSize="479,123" sap2010:WorkflowViewState.IdRef="BuildDataTable_11" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;SiteKey&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;TMWInstance&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;DirectoryNames&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;CE_Name&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Programs&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;RunDateTime&quot; msdata:Caption=&quot;&quot; type=&quot;xs:dateTime&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:BuildDataTable>
                  <ui:BuildDataTable DataTable="[dt_TechFields]" DisplayName="Build dt_TechFields" sap:VirtualizedContainerService.HintSize="479,92" sap2010:WorkflowViewState.IdRef="BuildDataTable_8" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;T_LastMilestone&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; default=&quot;Not Yet Attempted&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Job_Id&quot; msdata:Caption=&quot;&quot; default=&quot;DEBUG&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;12&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Job_HostMachineName&quot; msdata:Caption=&quot;&quot; default=&quot;Unknown&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;255&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Job_RobotUser&quot; msdata:Caption=&quot;&quot; default=&quot;Unknown&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;255&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;T_SourceKey&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;T_RetryNbr&quot; msdata:Caption=&quot;&quot; type=&quot;xs:int&quot; default=&quot;0&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;T_Key&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;255&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;T_Reference&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;255&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;T_Action&quot; msdata:Caption=&quot;&quot; default=&quot;Unknown&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;50&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;T_Success&quot; msdata:Caption=&quot;&quot; type=&quot;xs:boolean&quot; default=&quot;false&quot; /&gt;&#xA;                &lt;xs:element name=&quot;T_CanRetry&quot; msdata:Caption=&quot;&quot; type=&quot;xs:boolean&quot; default=&quot;true&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;T_ExceptionType&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;T_ExceptionMessage&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; default=&quot;Not Yet Attempted&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;T_ExecutionSeconds&quot; msdata:Caption=&quot;&quot; type=&quot;xs:int&quot; default=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;T_LastModTsp&quot; msdata:Caption=&quot;&quot; type=&quot;xs:dateTime&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                  <ui:MergeDataTable Destination="[dt_Report]" DisplayName="Merge TechFields columns into dt_Report" sap:VirtualizedContainerService.HintSize="479,165" sap2010:WorkflowViewState.IdRef="MergeDataTable_5" MissingSchemaAction="Add" Source="[dt_TechFields]" />
                  <ui:MultipleAssign DisplayName="Set Default Values for TechFields" sap:VirtualizedContainerService.HintSize="479,263" sap2010:WorkflowViewState.IdRef="MultipleAssign_7">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_37">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:Object">[dt_Report.Columns("Job_Id").DefaultValue]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:Object">[dict_Config("JobID").ToString]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_38">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:Object">[dt_Report.Columns("Job_HostMachineName").DefaultValue]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:Object">[dict_Config("MachineName").ToString]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_39">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:Object">[dt_Report.Columns("Job_RobotUser").DefaultValue]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:Object">[dict_Config("RobotUser").ToString]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap:VirtualizedContainerService.HintSize="334,25" sap2010:WorkflowViewState.IdRef="AssignOperation_40">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:Object">[dt_Report.Columns("T_Action").DefaultValue]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:Object">[dict_Config("Action").ToString]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_41">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:Object">[dt_Report.Columns("T_LastModTsp").DefaultValue]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:Object">[DateTime.Now]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                </Sequence>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke KillAllProcesses" sap:VirtualizedContainerService.HintSize="541,195" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_27" UnSafe="False" WorkflowFileName="Framework\Applications_Kill.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="in_AppList">[dict_Config("Application_KillList").ToString]</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InvokeWorkflowFile>
              </Sequence>
              <Sequence DisplayName="Add Custom Log Fields" sap:VirtualizedContainerService.HintSize="603,224" sap2010:WorkflowViewState.IdRef="Sequence_34">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:AddLogFields DisplayName="Add Log Fields" sap:VirtualizedContainerService.HintSize="388,113" sap2010:WorkflowViewState.IdRef="AddLogFields_3">
                  <ui:AddLogFields.Fields>
                    <InArgument x:TypeArguments="x:String" x:Key="Process">[dict_Config("Process").ToString]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="Action">[dict_Config("Action").ToString]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="PF_JobID">[dict_Config("JobID").ToString]</InArgument>
                    <InArgument x:TypeArguments="x:String" x:Key="PerformerType">[dict_Config("PerformerType").ToString]</InArgument>
                  </ui:AddLogFields.Fields>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:AddLogFields>
              </Sequence>
            </Sequence>
          </TryCatch.Try>
          <TryCatch.Catches>
            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="669,22" sap2010:WorkflowViewState.IdRef="Catch`1_3">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ActivityAction x:TypeArguments="s:Exception">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                </ActivityAction.Argument>
                <Sequence DisplayName="Catch Initialize Job" sap:VirtualizedContainerService.HintSize="496,366" sap2010:WorkflowViewState.IdRef="Sequence_68">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="434,173" sap2010:WorkflowViewState.IdRef="LogMessage_55" Level="Error" Message="[str_State &amp; &quot; State Failed: &quot; + exception.Message]">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:LogMessage>
                  <Assign sap:VirtualizedContainerService.HintSize="434,105" sap2010:WorkflowViewState.IdRef="Assign_54">
                    <Assign.To>
                      <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                    </Assign.Value>
                  </Assign>
                </Sequence>
              </ActivityAction>
            </Catch>
          </TryCatch.Catches>
        </TryCatch>
      </State.Entry>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">3,117</av:Point>
          <av:Size x:Key="ShapeSize">254,119</av:Size>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <x:Double x:Key="StateContainerWidth">220</x:Double>
          <x:Double x:Key="StateContainerHeight">25</x:Double>
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State.Exit>
        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke EndState workflow" sap:VirtualizedContainerService.HintSize="334,172" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_42" UnSafe="False" WorkflowFileName="Framework\State_End.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="x:String" x:Key="in_LeavingState">[str_State]</InArgument>
            <InArgument x:TypeArguments="s:DateTime" x:Key="in_StateStart">[tsp_StateStart]</InArgument>
          </ui:InvokeWorkflowFile.Arguments>
        </ui:InvokeWorkflowFile>
      </State.Exit>
      <State.Transitions>
        <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="674,510" sap2010:WorkflowViewState.IdRef="Transition_2">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
              <av:PointCollection x:Key="ConnectorLocation">130,236 130,442.5</av:PointCollection>
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <x:Reference>__ReferenceID0</x:Reference>
          </Transition.To>
          <Transition.Action>
            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_31" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Initialize Job</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Initialize Transaction</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Success</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_Condition">["ex_Exception Is Nothing AndAlso dict_Config(""PerformerType"").ToString.ToUpper &lt;&gt; ""PRELOAD"""]</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
            </ui:InvokeWorkflowFile>
          </Transition.Action>
          <Transition.Condition>[ex_Exception Is Nothing AndAlso dict_Config("PerformerType").ToString.ToUpper &lt;&gt; "PRELOAD"]</Transition.Condition>
        </Transition>
        <Transition DisplayName="Exception" sap:VirtualizedContainerService.HintSize="450,509" sap2010:WorkflowViewState.IdRef="Transition_12">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:PointCollection x:Key="ConnectorLocation">257,182.45 287,182.45 287,173 783,173</av:PointCollection>
              <x:Int32 x:Key="SrcConnectionPointIndex">40</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">5</x:Int32>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <x:Reference>__ReferenceID1</x:Reference>
          </Transition.To>
          <Transition.Action>
            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_30" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Initialize Job</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Finalize Job</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Exception</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_Condition">ex_Exception IsNot Nothing</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
            </ui:InvokeWorkflowFile>
          </Transition.Action>
          <Transition.Condition>[ex_Exception IsNot Nothing]</Transition.Condition>
        </Transition>
        <Transition DisplayName="PreLoad" sap:VirtualizedContainerService.HintSize="666,510" sap2010:WorkflowViewState.IdRef="Transition_24">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:PointCollection x:Key="ConnectorLocation">193.5,236 193.5,306.05 354.5,306.05</av:PointCollection>
              <x:Int32 x:Key="SrcConnectionPointIndex">59</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">25</x:Int32>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <State x:Name="__ReferenceID5" sap2010:Annotation.AnnotationText="For Performer Type PreLoad, load all transactions into dt_Report ahead of time instead of adding them as they are executed." DisplayName="PreLoad Transactions" sap:VirtualizedContainerService.HintSize="251,143" sap2010:WorkflowViewState.IdRef="State_8">
              <State.Entry>
                <Sequence DisplayName="PreLoad Items Main" sap:VirtualizedContainerService.HintSize="550,1115" sap2010:WorkflowViewState.IdRef="Sequence_191">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke StartState workflow" sap:VirtualizedContainerService.HintSize="488,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_76" UnSafe="False" WorkflowFileName="Framework\State_Start.xaml">
                    <ui:InvokeWorkflowFile.Arguments>
                      <InArgument x:TypeArguments="x:String" x:Key="in_StateName">PreLoad Items</InArgument>
                      <OutArgument x:TypeArguments="s:DateTime" x:Key="out_StateStart">[tsp_StateStart]</OutArgument>
                      <OutArgument x:TypeArguments="x:String" x:Key="out_StateName">[str_State]</OutArgument>
                    </ui:InvokeWorkflowFile.Arguments>
                  </ui:InvokeWorkflowFile>
                  <TryCatch DisplayName="Try PreLoad Items" sap:VirtualizedContainerService.HintSize="488,851" sap2010:WorkflowViewState.IdRef="TryCatch_18">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch.Try>
                      <Sequence DisplayName="Try Extract Items" sap:VirtualizedContainerService.HintSize="450,623" sap2010:WorkflowViewState.IdRef="Sequence_189">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="sd:DataTable" Name="dt_TempWorkItems" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Framework\Setup_Required\ExtractItems.xaml - Invoke Workflow File" sap:VirtualizedContainerService.HintSize="388,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_77" UnSafe="False" WorkflowFileName="Framework\Transaction_ExtractItems.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_WorkItems">[dt_TempWorkItems]</OutArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                        <ui:RemoveDataColumn Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="Status" DataTable="[dt_TempWorkItems]" DisplayName="Remove Data Column" sap:VirtualizedContainerService.HintSize="388,186" sap2010:WorkflowViewState.IdRef="RemoveDataColumn_1" />
                        <ui:MergeDataTable Destination="[dt_Report]" DisplayName="Merge Data Table" sap:VirtualizedContainerService.HintSize="388,133" sap2010:WorkflowViewState.IdRef="MergeDataTable_4" MissingSchemaAction="Add" Source="[dt_TempWorkItems]" />
                      </Sequence>
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="454,21" sap2010:WorkflowViewState.IdRef="Catch`1_19">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="Exception" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="PreLoad Items" sap:VirtualizedContainerService.HintSize="496,374" sap2010:WorkflowViewState.IdRef="Sequence_190">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,141" sap2010:WorkflowViewState.IdRef="LogMessage_85" Level="Error" Message="[str_State &amp; &quot; State Failed: &quot; &amp; Exception.Message]" />
                            <Assign sap:VirtualizedContainerService.HintSize="434,82" sap2010:WorkflowViewState.IdRef="Assign_140">
                              <Assign.To>
                                <OutArgument x:TypeArguments="s:Exception">[ex_Exception]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="s:Exception">[Exception]</InArgument>
                              </Assign.Value>
                            </Assign>
                          </Sequence>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                  </TryCatch>
                </Sequence>
              </State.Entry>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">354.5,256</av:Point>
                  <av:Size x:Key="ShapeSize">251,143</av:Size>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Double x:Key="StateContainerWidth">217</x:Double>
                  <x:Double x:Key="StateContainerHeight">34</x:Double>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <State.Exit>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke EndState workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_78" UnSafe="False" WorkflowFileName="Framework\State_End.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="in_LeavingState">[str_State]</InArgument>
                    <InArgument x:TypeArguments="s:DateTime" x:Key="in_StateStart">[tsp_StateStart]</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
              </State.Exit>
              <State.Transitions>
                <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="450,510" sap2010:WorkflowViewState.IdRef="Transition_25">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:PointCollection x:Key="ConnectorLocation">354.5,356.1 167.65,356.1 167.65,442.5</av:PointCollection>
                      <x:Int32 x:Key="SrcConnectionPointIndex">53</x:Int32>
                      <x:Int32 x:Key="DestConnectionPointIndex">50</x:Int32>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Transition.To>
                    <x:Reference>__ReferenceID0</x:Reference>
                  </Transition.To>
                  <Transition.Action>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_89" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">PreLoad Items</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Initialize Transaction</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Success</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Condition">ex_Exception Is Nothing</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </Transition.Action>
                  <Transition.Condition>[ex_Exception Is Nothing]</Transition.Condition>
                </Transition>
                <Transition DisplayName="Exception" sap:VirtualizedContainerService.HintSize="450,509" sap2010:WorkflowViewState.IdRef="Transition_26">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:PointCollection x:Key="ConnectorLocation">605.5,334.65 635.5,334.65 635.5,314.25 783,314.25</av:PointCollection>
                      <x:Int32 x:Key="SrcConnectionPointIndex">40</x:Int32>
                      <x:Int32 x:Key="DestConnectionPointIndex">25</x:Int32>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Transition.To>
                    <x:Reference>__ReferenceID1</x:Reference>
                  </Transition.To>
                  <Transition.Action>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_88" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">PreLoad Items</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">Finalize Job</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">Exception</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="in_Condition">ex_Exception IsNot Nothing</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </Transition.Action>
                  <Transition.Condition>[ex_Exception IsNot Nothing]</Transition.Condition>
                </Transition>
              </State.Transitions>
            </State>
          </Transition.To>
          <Transition.Action>
            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke LogTransition workflow" sap:VirtualizedContainerService.HintSize="334,113" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_79" UnSafe="False" WorkflowFileName="Framework\State_LogTransition.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <InArgument x:TypeArguments="x:String" x:Key="in_SourceState">Initialize Job</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationState">PreLoad Items</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_TransitionName">PreLoad</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_Condition">["ex_Exception Is Nothing AndAlso dict_Config(""PerformerType"").ToString.ToUpper = ""PRELOAD"""]</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
            </ui:InvokeWorkflowFile>
          </Transition.Action>
          <Transition.Condition>[ex_Exception Is Nothing AndAlso dict_Config("PerformerType").ToString.ToUpper = "PRELOAD"]</Transition.Condition>
        </Transition>
      </State.Transitions>
    </State>
    <x:Reference>__ReferenceID3</x:Reference>
    <x:Reference>__ReferenceID4</x:Reference>
    <x:Reference>__ReferenceID5</x:Reference>
    <StateMachine.Variables>
      <Variable x:TypeArguments="x:Int32" Name="int_ConsecutiveSE" />
      <Variable x:TypeArguments="x:Boolean" Name="bln_LastTransaction" />
      <Variable x:TypeArguments="x:Boolean" Name="bln_ShouldStop" />
      <Variable x:TypeArguments="x:Boolean" Name="bln_MoreTransactions" />
      <Variable x:TypeArguments="x:Int32" Default="0" Name="int_TIndex" />
      <Variable x:TypeArguments="s:DateTime" Name="tsp_StateStart" />
      <Variable x:TypeArguments="x:String" Name="str_State" />
      <Variable x:TypeArguments="ui:QueueItem" Name="qi_Current" />
      <Variable x:TypeArguments="ui:Image" Name="img_ExceptionScreenshot" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Default="[New Dictionary(Of String, String)]" Name="dict_Config" />
      <Variable x:TypeArguments="sd:DataTable" Default="[New DataTable]" Name="dt_Report" />
      <Variable x:TypeArguments="s:Exception" Name="ex_Exception" />
      <Variable x:TypeArguments="sd:DataTable" Default="[New DataTable]" Name="dt_ReportDetails" />
      <Variable x:TypeArguments="x:Int32" Default="0" Name="int_MostConsecutiveSE" />
      <Variable x:TypeArguments="s:DateTime" Name="tsp_TransactionStart" />
    </StateMachine.Variables>
  </StateMachine>
</Activity>